{
  "hash": "b8730b5a6d8e4b0223333cf2c37e0c75",
  "result": {
    "markdown": "---\ntitle: \"Take-Home Exercise 3\"\nauthor: \"Hin Phung\"\ndate: \"9 Jun 2023\"\ndate-modified: \"2023-06-16\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\neditor: visual\n---\n\n\n\n# Overview\n\n### Introduction\n\nThe country of Oceanus has sought FishEye International's help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye's analysts had received import/export data for Oceanus' marine and fishing industries, but the data is incomplete. FishEye had subsequently transformed the trade data into a knowledge graph to help them understand the business relationships, including finding links that will stop IUU fishing and protect marine species.\n\nWe will address Question 1 of VAST challenge 2023 MC3 - To Use visual analytics to identify anomalies in the business groups present in the knowledge graph\n\n### Methodology\n\nTo use different visualisation techniques to identify relationships and anomalies of entities in the businesss groups.\n\n### Data Preparation\n\n#### Installing and loading of R packages\n\nThe code chunk below will be used to install and load the necessary R packages as follows:\n\n-   jsonlite: a package supports both reading and writing JSON files, as well as working with JSON data retrieved from web APIs.\n\n-   igraph: a package in R that offers a wide range of tools for creating, manipulating, and visualizing graphs, as well as various algorithms and metrics for network analysis.\n\n-   tidygraph: provides a tidy and consistent approach to working with graph data using the principles of the tidyverse\n\n-   ggraph: an extension package in R that builds upon the tidygraph and ggplot2 packages. It provides a high-level interface for creating visualizations of graph data using the grammar of graphics approach.\n\n-   viznetwork: a package provides geoms for ggplot2 to repel overlapping text labels.\n\n-   graphlayouts: a package that provides a collection of layout algorithms that can be used to visualize graphs.\n\n-   ggforce: extension package for ggplot2 that provides additional functionalities and extensions to enhance and expand the capabilities of ggplot2 for data visualization.\n\n-   tidyverse: a family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.\n\n-   scales: package that provides various functions for scaling and formatting data, primarily for data visualization purposes.\n\n-   wordcloud: package for creating word clouds, which are visual representations of textual data where the size of each word corresponds to its frequency or importance in the text.\n\n-   tm: text mining package that provides tools for text preprocessing, document-term matrix creation, and various other text mining tasks.\n\n-   treemap: a package that allows you to create treemaps, which are visualizations that display hierarchical data as nested rectangles.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npacman::p_load(jsonlite, tidygraph, ggraph, \n               visNetwork, graphlayouts, ggforce, \n               skimr, tidytext, tidyverse, scales, wordcloud, tm, treemap)\n```\n:::\n\n\n# The Data\n\nThe function fromJSON() of jsonlite package is used to import mc3.json into R environment. The data comprises:\n\n-   list of 27622 \"nodes\" with 5 columns (id, country, type, revenue_omu, project_services)\n\n-   list of 24038 \"links\" with 3 columns (source, target, type)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_data <- fromJSON(\"data/MC3.json\")\n```\n:::\n\n\n# Data Preparation\n\nThe list of \"links\" are extracted to form an edge table. Correspondingly, the list of \"nodes\" are extracted to form a nodes table.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Extract edges from the list\nmc3_edges <- as_tibble(mc3_data$links) %>% \n  distinct() %>%\n  mutate(source = as.character(source),\n         target = as.character(target),\n         type = as.character(type)) %>%\n  group_by(source, target, type) %>%\n    summarise(weights = n()) %>%\n  filter(source!=target) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Extract nodes from the list\nmc3_nodes <- as_tibble(mc3_data$nodes) %>%\n  mutate(country = as.character(country),\n         id = as.character(id),\n         product_services = as.character(product_services),\n         revenue_omu = as.numeric(as.character(revenue_omu)),\n         type = as.character(type)) %>%\n  select(id, country, type, revenue_omu, product_services)\n```\n:::\n\n\n# Data Exploration\n\n### Exploring edge table\n\nWe first explore the created edge table. The report below reveals that there are not missing values in all fields.We also made comparison between Different types in the edge table. The bar graph below indicates that there are 2 types of entities in the edge table - company contacts and owners.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskim(mc3_edges)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |mc3_edges |\n|Number of rows           |24036     |\n|Number of columns        |4         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |3         |\n|numeric                  |1         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|source        |         0|             1|   6| 700|     0|    12856|          0|\n|target        |         0|             1|   6|  28|     0|    21265|          0|\n|type          |         0|             1|  16|  16|     0|        2|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate| mean| sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|----:|--:|--:|---:|---:|---:|----:|:-----|\n|weights       |         0|             1|    1|  0|  1|   1|   1|   1|    1|▁▁▇▁▁ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_edges, aes(x = type, fill = type)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Exploring nodes table\n\nSimilarly, we explore the created nodes table. The report above reveals that there are 21515 missing values under \"revenue_omu\" column and these rows will be subsequently removed when visualising the revenues of the companies. The bar graph comparing the types of entities in the nodes table reveal that there are 3 types of entities - company, company contacts and owners.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskim(mc3_nodes)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |mc3_nodes |\n|Number of rows           |27622     |\n|Number of columns        |5         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |4         |\n|numeric                  |1         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable    | n_missing| complete_rate| min|  max| empty| n_unique| whitespace|\n|:----------------|---------:|-------------:|---:|----:|-----:|--------:|----------:|\n|id               |         0|             1|   6|   64|     0|    22929|          0|\n|country          |         0|             1|   2|   15|     0|      100|          0|\n|type             |         0|             1|   7|   16|     0|        3|          0|\n|product_services |         0|             1|   4| 1737|     0|     3244|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|       sd|      p0|     p25|      p50|      p75|      p100|hist  |\n|:-------------|---------:|-------------:|-------:|--------:|-------:|-------:|--------:|--------:|---------:|:-----|\n|revenue_omu   |     21515|          0.22| 1822155| 18184433| 3652.23| 7676.36| 16210.68| 48327.66| 310612303|▇▁▁▁▁ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_nodes, aes(x = type, fill = type)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Data Wrangling\n\nWe would need to extract the lists of entities found under the \"Source\" column in the edges table, and itemise them in separate rows. This is done by splitting the string in the lists into a new edges table, after removing whitespaces and irrelevant characters.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Break up the lists in the edge file by splitting the string\nmc3_edge_broken <- unnest(mc3_edges, source = strsplit(as.character(source), \"\\\\(|\\\\,|\\\\)\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Remove whitespaces amd filter records with \"c\" value \nmc3_edge_broken <- mc3_edge_broken %>%\n  mutate(source = gsub(\"\\\"\", \"\", source)) %>%\n  filter(source !=\"c\") %>%\n  mutate(source = trimws(source)) %>%\n  mutate(target = trimws(target)) %>%\n  group_by(source, target, type) %>%\n  summarise(weights = n()) %>%\n  filter(source != target) %>%\n  ungroup()\n```\n:::\n\n\nNext we will join the edges table with nodes table into combined edge table by mapping edge \"source\" column in edge table with \"id\" column in nodes table. This will provide us with the information on the type of \"source\" entities in the edges table. The edges table will be used to derive the data for subsequent visualisation.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_bysource <- left_join(mc3_edge_broken, mc3_nodes,\n                               by = c(\"source\" = \"id\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Rename relevant columns as \"source type\" and \"target type\"\n#Filter combined edge table by removing unknown and NA values from relevant columns.\nmc3_edges_bysource1 <- mc3_edges_bysource %>%\n  group_by(source, target, type.y, type.x, country, weights, revenue_omu, product_services) %>%\n  filter(source!=target) %>%\n  rename(source_type = type.y) %>%\n  rename(target_type = type.x) %>%\n  #filter(revenue_omu != \"NA\") %>%\n  filter(product_services != \"Unknown\") %>%\n  filter(product_services != \"character(0)\") %>%\n  ungroup()\n```\n:::\n\n\n# Visualisation\n\n### Countries registered by top revenue companies\n\nThe treemap is constructed based on the top 50 companies that generates the highest revenues. It is observed that, of the top 50 companies with the highest revenues, almost half of the total revenues are earned by companies registered in ZH country. The 2 highest earning companies are Jones LLC and Patton Ltd. The diagram also revealed that Assam Limited Liability Company and Aqua Advancements Sashimi SE Express are the highest earning company in Utoporiana country and Oceanus country respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Derive new edge table\nmc3_edges_toprevenue <- mc3_edges_bysource1 %>%\n  select (source, source_type, country, weights, revenue_omu, product_services) %>%\n  group_by(source) %>%\n  arrange(desc(revenue_omu)) %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter top 50 companies with highest revenues\nmc3_edges_toprevenue_filtered <- mc3_edges_toprevenue %>%\n  filter (source_type == \"Company\") %>%\n  slice_max(order_by = revenue_omu, n = 50)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Construct treemap\ntreemap(mc3_edges_toprevenue_filtered,\n        index=c(\"country\", \"source\"),\n        vSize=\"revenue_omu\",\n        vColor=\"revenue_omu\",\n        title=\"Revenue by Country and Company\",\n        title.legend = \"revenue of company\"\n        )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### Individual owners with multiple companies\n\nOne of the anormalies that we can detect is the number of companies the individual entities own. We can be suspicious of these individuals if they own an exceptionally high number of companies.\n\nIn this visualisation, we can observe that there are seven individuals (Richard Smith, Jennifer Smith, James Smith, Jennifer Taylor, Micheal Williams, John Williams, Ashley Harris) who own the largest number of companies (total of 8 companies each). We can also infer that there are two big families among the above list - the Smith family and Williams family. In addition, we can detect that Michael Williams and David Jones co-own Garcia, as well as Ashley Harris and Amy Martinez co-own Davis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter individual owners from edge table, and assign target to be source and vice versa\nmc3_edges_indivowners <- mc3_edges_bysource %>%\n  select (target, source, type.x, weights) %>%\n  group_by(target) %>%\n  filter(type.x == \"Beneficial Owner\") %>%\n  rename (sc = target) %>%\n  rename (tg = source) %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter individuals who own more 5 companies\nmc3_edges_indivowners_filtered <- subset(mc3_edges_indivowners, ave(sc, sc, FUN = length) > 5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create corresponding nodes table out of the edges table\nid1_inv <- mc3_edges_indivowners_filtered %>%\n  select(sc) %>%\n  rename(id = sc)\nid2_inv <- mc3_edges_indivowners_filtered %>%\n  select(tg) %>%\n  rename(id = tg)\nmc3_nodes_indivowners_filtered <- rbind(id1_inv, id2_inv) %>%\n  distinct()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#prep format for plotting\nmc3_edges_indivowners_filtered <- mc3_edges_indivowners_filtered %>%\nrename(from = sc) %>%\nrename(to = tg) %>%\n#filter (target_type == \"companies\") %>%\nfilter(from!=to) %>%\nungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Plot interactive graph\nvisNetwork(mc3_nodes_indivowners_filtered, mc3_edges_indivowners_filtered) %>%\n  visNodes(color = list(background = \"pink\", border = \"red\")) %>%\n  visEdges(arrows = \"to\") %>%\n  visIgraphLayout(layout = \"layout_with_gem\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-1e0fbe4a598817415ae2\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1e0fbe4a598817415ae2\">{\"x\":{\"nodes\":{\"id\":[\"Richard Smith\",\"David Jones\",\"Michael Miller\",\"David Thomas\",\"Mark Miller\",\"Anna Wheeler\",\"Michael Bell\",\"Joshua Smith\",\"Joshua Martin\",\"John Gonzalez\",\"Ashley Harris\",\"Michael Williams\",\"Amy Williams\",\"James Smith\",\"Jennifer Smith\",\"Amy Martinez\",\"Jennifer Taylor\",\"Michael Jackson\",\"Christopher Jones\",\"John Williams\",\"Lisa Johnson\",\"Acevedo\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Alvarez\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Andrews\",\"Aqua Adventures Ltd. Corporation\",\"Aqua Aura SE Marine life\",\"Aqua Gourmet Incorporated Creek\",\"Arnold\",\"Ashley\",\"Assam   Ltd. Liability Co\",\"Baker\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Barnett\",\"Beach Bums Corporation Transit\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brisa del Mar GmbH\",\"Brown and Alvarez\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chase\",\"Chavez PLC\",\"Choi and Merritt\",\"Christensen and Bender\",\"Collins and Johnson\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis\",\"Dean-Fisher\",\"Deep Sea Divers BV Logistics\",\"Dickson and Gonzalez\",\"Dnipro  Saltwater N.V. Services\",\"Dutch Mussels S.p.A. Sea spray\",\"Ferguson and Miller\",\"Finley and Mcdaniel\",\"Fowler-Davis\",\"Garcia\",\"Garcia and Acevedo\",\"Garcia and Harris\",\"Graham Inc\",\"Group S.A. de C.V.\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hernandez\",\"Hernandez and Wade\",\"Herring\",\"Horton and Lewis\",\"Jacobs-Henry\",\"Johnson\",\"Johnson and Wright\",\"Karelians Plc Marine conservation\",\"Kariba Dam   CJSC Marine sanctuary\",\"Khundu N.V. and Son's\",\"Kidd and Hall\",\"Kline and Roberts\",\"Kong zhong diao yu  GmbH\",\"Lang\",\"Lara\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Ltd. Corporation Ltd. Corporation\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Maacama  S.p.A. Marine ecology\",\"Malawi Rift   S.A. de C.V. Express\",\"Malone and Willis\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal S.A. de C.V.\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Mar del Placer Plc\",\"Marine Muse Pic Marine ecology\",\"Martinez\",\"Matthews and White\",\"Meadows\",\"Melanippe GmbH & Co. KG\",\"Merritt-Austin\",\"Montes\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Norwegian Fjord  S.A. de C.V. Brothers\",\"Náutica del Mar GmbH & Co. KG\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Phillips and Moody\",\"Playa de Arena Ltd. Liability Co\",\"Playa de la Luna Starfish\",\"Portuguese Sea Bass & N.V. Logistics\",\"Punjab  Market Ltd. Liability Co Brothers\",\"Punjab s Pic Express\",\"Reese\",\"Reyes-Kelly\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Rufiji Delta  Limited Liability Company\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"Sea Striders Kelp BV Solutions\",\"SeaSelect Foods Salt spray\",\"SeaSolutions Dry dock OJSC Transit\",\"SeaSolutions Leska Kga Worldwide\",\"Seashell Sanctum Co Family\",\"Selkie GmbH Marine life\",\"Shepherd and Phillips\",\"SilverScales Ltd. Liability Co\",\"Simon and Farmer\",\"Singleton Ltd\",\"Smith and Harrison\",\"Smith and Scott\",\"Spanish Shrimp A/S Marine\",\"Sullivan\",\"Taylor\",\"Thetis Ltd. Liability Co\",\"Thompson\",\"TideTurner Tidepool Co Enterprises\",\"Tucker-Turner\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Uttar Pradesh Sea  United\",\"Velazquez-Harris\",\"Vespuci Sandbar Sp Brothers\",\"Walker-Lozano\",\"Webb and Martin\",\"Werner-Ortiz\",\"West Bengal  Co _\",\"West Fish  GmbH Transport\",\"Wise and Fuentes\",\"Wright LLC\",\"Young and Ramos\",\"hǎi mǎ S.p.A. Transport\",\"hǎi zhé S.A. de C.V.\",\"jīn qiāng yú AG\",\"mán yú BV Coral Reef\"],\"x\":[0.0794695582203746,-0.256754269662919,-0.776403412538838,0.480941316361662,0.762390404427141,0.426632424293302,-0.695883377754365,-0.110257400383772,-0.590439936535922,-0.47423796841087,0.30073058935478,-0.308471034784238,0.0630811836747638,0.0201519937671577,-0.0410337178187021,0.715683063237717,-0.200052404914247,0.446163723124754,-0.213167459308793,0.0940976179524851,0.147243435004693,0.119438400267827,-0.44002643416139,-0.311374614281014,-1,0.63496581052286,0.940553268119074,0.576266867283961,-0.922012151653202,0.951476271908788,0.180908391051952,-0.195021031899479,-0.791616632234766,-0.532446136684572,0.650611707672463,-0.692419478120463,-0.239360711053741,0.65318620051918,-0.871897430759853,0.49429394660488,-0.760716366547768,-0.498233552688041,0.479956463603105,-0.514306378664469,0.134791377077853,0.0336012055568911,0.142932830883074,-0.186091995626149,-0.659725736861545,-0.41855929683738,-0.200611083053216,-0.501570095067772,0.587330581107911,-0.910030855386698,0.183446678592363,0.203917515709121,0.977650611718604,-0.192243576035414,-0.358964219746595,1,-0.977798467110938,-0.45110361346379,-0.635667875953986,-0.396217511421724,-0.0835957871000064,0.634091669776852,0.100603348288324,-0.127515943424707,-0.168501441036053,0.0864249815580067,-0.666118234029544,0.927616938376197,-0.057531507345118,-0.651931286581716,-0.734114501921291,0.218638483637689,-0.348271072011574,0.934685503069984,0.37887699349165,0.568541915444289,0.192518917186481,-0.222755770064959,0.470073612380026,-0.837841854178103,0.175208808931838,-0.911306469563882,0.0132072109303862,0.134012354247677,-0.156114047823156,0.964082668808215,-0.00340975428659351,-0.049768678756302,0.235639387400198,0.496094879802611,-0.192661817614916,-0.115180183572339,0.564769051857222,0.576903583953308,0.862561126101142,0.904615833896998,0.204715151195322,-0.273177119061049,0.643111013715179,0.435904066082535,-0.00656864764624177,0.592979577009822,0.975698973232966,0.633757910022769,0.670326274980767,-0.487439331854404,0.261050218822008,0.615119941157983,-0.117772476598103,-0.57674448260588,-0.30041762148231,0.0359021184207797,-0.934673266582275,-0.881020833258431,-0.150256060139268,-0.997713152041702,-0.37885548545748,0.0835046554954628,0.516932804116663,0.603035509762077,-0.442383965497691,-0.446027290332544,-0.3798637789149,-0.278524641350178,0.281703843334482,0.233071042057277,0.917702227594427,-0.774398402120125,-0.33765628276785,-0.0395028366255172,0.179941394378456,-0.387784323438916,-0.255142901301831,-0.481180008916425,0.147117115096684,0.283332994112837,0.0409177672753385,0.200369450189805,-0.344718698897872,0.236185000525064,-0.609584102231607,0.229219268718681,0.258138508697453,0.271381812486353,0.517918100168808,-0.525152378418922,-0.207730171070966,0.0523427903402487,0.504626927339943,-0.321780985603129,0.616847338973627,-0.973069746564291,0.0834204089448316,0.420962321661361,-0.975021525771215,0.0966215838994946,0.151381666376005,0.537617180468327,-0.0947856284797727],\"y\":[-0.212386725218138,-0.277213492405228,-0.118333864999207,-0.586420211316923,-0.00365298768386779,-0.156163563157717,0.289612341960578,-0.411054730466622,-0.574162728259815,0.60070333269272,0.230720159407718,-0.0346101905051973,0.55103838795084,0.169737047304359,0.0147642865228372,0.307505030705771,0.195126652748625,0.68663795924148,0.761528729009973,0.0181289815053569,-0.760303199985544,-0.38874334326767,-0.400844388985574,-0.478354184874367,-0.174084201555047,-0.770577864887219,-0.124167657337204,-0.287294926263197,0.31660234255684,-0.0347663618115063,-0.352923569605113,-0.639792129737585,-0.641538676449398,0.809409831696635,-0.180811207841974,-0.761956745174575,-0.594423699626694,-0.725572727761743,0.420826645328002,0.195648104464324,-0.724794247222446,-0.0873211989572237,0.360629028733109,0.0238609600391071,0.77462782033706,-0.392545289167511,0.321438074884071,-0.587673868748598,0.727001625624652,-0.45025144928297,0.0144276047828638,-0.134288352959721,0.334865893650597,0.374391154143,0.748386196142994,-0.405973742128128,-0.0776183051887521,-0.0586770424241095,-0.473975514089312,-0.0178892213536302,-0.131270240912658,-0.229432117064344,0.789910107839269,0.266272032594364,-0.643837953181828,0.796079693460673,0.364784712269902,0.13099067464011,0.972556245692985,0.786575973316779,0.678298680833192,0.30599721153982,0.339793026979326,-0.784836541604079,-0.763435052132104,-0.0338466562672477,0.936178046185224,0.355495166706467,0.417182364875578,0.89386821774161,-0.959837516977333,0.410467733861527,0.917846648955204,0.454022646008928,-1,0.262076487790142,-0.0994995993783411,-0.999278079323029,-0.107136853844303,0.0780466771919841,0.743526216545139,-0.14823715899847,-0.984475619010365,0.302221760422449,0.0814697153302952,-0.141396863673162,0.840701924615296,-0.808813553160654,0.464630062791632,0.433616371783141,0.707176542715516,0.407363383569142,-0.253907844796912,0.359927320574633,0.370009641686994,-0.754899058870769,0.0312787892480542,-0.128537295111046,-0.677234918580285,-0.0199228147609232,0.102850349879563,-0.21686529698088,-0.612888771556956,0.802835702463821,0.346194687750487,0.772059941520544,-0.241440953777977,0.344784608236425,-0.649110797611257,-0.0958576853503905,-0.413056801289037,-0.962744680523765,-0.792535230519226,-0.302327135644731,-0.143881449268267,-0.350573126382058,0.331380228523371,0.949844249371976,0.0289627916019388,-0.0937385267869733,0.392063811147257,-0.686460415291687,0.381544325343463,-0.610057084904866,-0.132154093629485,0.21981575066716,0.995933370465759,0.0693566621678998,0.261267570615249,-0.0390919235231638,0.382856930835894,0.146716704222963,0.292803207202305,-0.343383583463193,0.753976543277359,0.0485203219917036,-0.29727866958556,-0.947878221242487,0.901331350409483,-0.0408597740262399,1,0.315765075394554,0.252838549809567,0.97251260122944,0.84815866950485,-0.211395154607349,-0.419850353489948,0.405088866541599,-0.0522868889747974,0.730800487470089,-0.430910740598284,-0.331712940075458,0.299328498908259],\"label\":[\"Richard Smith\",\"David Jones\",\"Michael Miller\",\"David Thomas\",\"Mark Miller\",\"Anna Wheeler\",\"Michael Bell\",\"Joshua Smith\",\"Joshua Martin\",\"John Gonzalez\",\"Ashley Harris\",\"Michael Williams\",\"Amy Williams\",\"James Smith\",\"Jennifer Smith\",\"Amy Martinez\",\"Jennifer Taylor\",\"Michael Jackson\",\"Christopher Jones\",\"John Williams\",\"Lisa Johnson\",\"Acevedo\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Alvarez\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Andrews\",\"Aqua Adventures Ltd. Corporation\",\"Aqua Aura SE Marine life\",\"Aqua Gourmet Incorporated Creek\",\"Arnold\",\"Ashley\",\"Assam   Ltd. Liability Co\",\"Baker\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Barnett\",\"Beach Bums Corporation Transit\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brisa del Mar GmbH\",\"Brown and Alvarez\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chase\",\"Chavez PLC\",\"Choi and Merritt\",\"Christensen and Bender\",\"Collins and Johnson\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis\",\"Dean-Fisher\",\"Deep Sea Divers BV Logistics\",\"Dickson and Gonzalez\",\"Dnipro  Saltwater N.V. Services\",\"Dutch Mussels S.p.A. Sea spray\",\"Ferguson and Miller\",\"Finley and Mcdaniel\",\"Fowler-Davis\",\"Garcia\",\"Garcia and Acevedo\",\"Garcia and Harris\",\"Graham Inc\",\"Group S.A. de C.V.\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hernandez\",\"Hernandez and Wade\",\"Herring\",\"Horton and Lewis\",\"Jacobs-Henry\",\"Johnson\",\"Johnson and Wright\",\"Karelians Plc Marine conservation\",\"Kariba Dam   CJSC Marine sanctuary\",\"Khundu N.V. and Son's\",\"Kidd and Hall\",\"Kline and Roberts\",\"Kong zhong diao yu  GmbH\",\"Lang\",\"Lara\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Ltd. Corporation Ltd. Corporation\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Maacama  S.p.A. Marine ecology\",\"Malawi Rift   S.A. de C.V. Express\",\"Malone and Willis\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal S.A. de C.V.\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Mar del Placer Plc\",\"Marine Muse Pic Marine ecology\",\"Martinez\",\"Matthews and White\",\"Meadows\",\"Melanippe GmbH & Co. KG\",\"Merritt-Austin\",\"Montes\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Norwegian Fjord  S.A. de C.V. Brothers\",\"Náutica del Mar GmbH & Co. KG\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Phillips and Moody\",\"Playa de Arena Ltd. Liability Co\",\"Playa de la Luna Starfish\",\"Portuguese Sea Bass & N.V. Logistics\",\"Punjab  Market Ltd. Liability Co Brothers\",\"Punjab s Pic Express\",\"Reese\",\"Reyes-Kelly\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Rufiji Delta  Limited Liability Company\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"Sea Striders Kelp BV Solutions\",\"SeaSelect Foods Salt spray\",\"SeaSolutions Dry dock OJSC Transit\",\"SeaSolutions Leska Kga Worldwide\",\"Seashell Sanctum Co Family\",\"Selkie GmbH Marine life\",\"Shepherd and Phillips\",\"SilverScales Ltd. Liability Co\",\"Simon and Farmer\",\"Singleton Ltd\",\"Smith and Harrison\",\"Smith and Scott\",\"Spanish Shrimp A/S Marine\",\"Sullivan\",\"Taylor\",\"Thetis Ltd. Liability Co\",\"Thompson\",\"TideTurner Tidepool Co Enterprises\",\"Tucker-Turner\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Uttar Pradesh Sea  United\",\"Velazquez-Harris\",\"Vespuci Sandbar Sp Brothers\",\"Walker-Lozano\",\"Webb and Martin\",\"Werner-Ortiz\",\"West Bengal  Co _\",\"West Fish  GmbH Transport\",\"Wise and Fuentes\",\"Wright LLC\",\"Young and Ramos\",\"hǎi mǎ S.p.A. Transport\",\"hǎi zhé S.A. de C.V.\",\"jīn qiāng yú AG\",\"mán yú BV Coral Reef\"]},\"edges\":{\"from\":[\"Richard Smith\",\"David Jones\",\"David Jones\",\"Michael Miller\",\"David Thomas\",\"Mark Miller\",\"Anna Wheeler\",\"Michael Bell\",\"Mark Miller\",\"Richard Smith\",\"Joshua Smith\",\"Joshua Martin\",\"John Gonzalez\",\"Anna Wheeler\",\"Joshua Martin\",\"Joshua Smith\",\"David Thomas\",\"Michael Bell\",\"Ashley Harris\",\"Joshua Martin\",\"Michael Williams\",\"Ashley Harris\",\"Michael Williams\",\"Amy Williams\",\"Richard Smith\",\"James Smith\",\"Joshua Smith\",\"John Gonzalez\",\"David Jones\",\"Jennifer Smith\",\"Michael Williams\",\"Amy Martinez\",\"Ashley Harris\",\"Michael Bell\",\"Amy Williams\",\"Richard Smith\",\"Mark Miller\",\"Jennifer Smith\",\"David Jones\",\"Mark Miller\",\"Michael Miller\",\"David Jones\",\"Michael Williams\",\"John Gonzalez\",\"Jennifer Taylor\",\"Joshua Smith\",\"Michael Jackson\",\"James Smith\",\"Jennifer Smith\",\"Christopher Jones\",\"Amy Williams\",\"John Gonzalez\",\"Amy Martinez\",\"James Smith\",\"Joshua Martin\",\"Joshua Martin\",\"John Williams\",\"Christopher Jones\",\"Amy Martinez\",\"Ashley Harris\",\"Michael Jackson\",\"Lisa Johnson\",\"Jennifer Taylor\",\"Michael Jackson\",\"Michael Bell\",\"Lisa Johnson\",\"Michael Bell\",\"Jennifer Smith\",\"Lisa Johnson\",\"Jennifer Smith\",\"Mark Miller\",\"Amy Williams\",\"Jennifer Smith\",\"Lisa Johnson\",\"Ashley Harris\",\"Jennifer Smith\",\"Jennifer Smith\",\"Michael Jackson\",\"David Thomas\",\"Amy Martinez\",\"Amy Martinez\",\"Amy Williams\",\"Jennifer Taylor\",\"Anna Wheeler\",\"Ashley Harris\",\"James Smith\",\"David Thomas\",\"Mark Miller\",\"Anna Wheeler\",\"David Thomas\",\"Michael Williams\",\"John Williams\",\"Anna Wheeler\",\"Joshua Smith\",\"John Gonzalez\",\"Jennifer Taylor\",\"Amy Williams\",\"Michael Miller\",\"Michael Bell\",\"Joshua Smith\",\"Michael Miller\",\"David Jones\",\"Lisa Johnson\",\"David Thomas\",\"Anna Wheeler\",\"Michael Williams\",\"David Jones\",\"Jennifer Taylor\",\"Christopher Jones\",\"John Williams\",\"John Williams\",\"Amy Martinez\",\"Joshua Martin\",\"Jennifer Taylor\",\"Joshua Smith\",\"John Williams\",\"Jennifer Taylor\",\"Christopher Jones\",\"Michael Williams\",\"James Smith\",\"John Williams\",\"James Smith\",\"John Williams\",\"Jennifer Taylor\",\"Richard Smith\",\"John Gonzalez\",\"John Williams\",\"Richard Smith\",\"Lisa Johnson\",\"Michael Jackson\",\"Michael Williams\",\"Christopher Jones\",\"James Smith\",\"Ashley Harris\",\"Christopher Jones\",\"Michael Jackson\",\"Michael Miller\",\"Richard Smith\",\"Ashley Harris\",\"Michael Miller\",\"Amy Williams\",\"Richard Smith\",\"Anna Wheeler\",\"James Smith\"],\"to\":[\"Acevedo\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Alvarez\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Andrews\",\"Aqua Adventures Ltd. Corporation\",\"Aqua Aura SE Marine life\",\"Aqua Gourmet Incorporated Creek\",\"Arnold\",\"Ashley\",\"Assam   Ltd. Liability Co\",\"Baker\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Barnett\",\"Beach Bums Corporation Transit\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brisa del Mar GmbH\",\"Brown and Alvarez\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chase\",\"Chavez PLC\",\"Choi and Merritt\",\"Christensen and Bender\",\"Collins and Johnson\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis\",\"Davis\",\"Dean-Fisher\",\"Deep Sea Divers BV Logistics\",\"Dickson and Gonzalez\",\"Dnipro  Saltwater N.V. Services\",\"Dutch Mussels S.p.A. Sea spray\",\"Ferguson and Miller\",\"Finley and Mcdaniel\",\"Fowler-Davis\",\"Garcia\",\"Garcia\",\"Garcia and Acevedo\",\"Garcia and Harris\",\"Graham Inc\",\"Group S.A. de C.V.\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hernandez\",\"Hernandez and Wade\",\"Herring\",\"Horton and Lewis\",\"Jacobs-Henry\",\"Johnson\",\"Johnson and Wright\",\"Karelians Plc Marine conservation\",\"Kariba Dam   CJSC Marine sanctuary\",\"Khundu N.V. and Son's\",\"Kidd and Hall\",\"Kline and Roberts\",\"Kong zhong diao yu  GmbH\",\"Lang\",\"Lara\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Ltd. Corporation Ltd. Corporation\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Maacama  S.p.A. Marine ecology\",\"Malawi Rift   S.A. de C.V. Express\",\"Malone and Willis\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal S.A. de C.V.\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Mar del Placer Plc\",\"Marine Muse Pic Marine ecology\",\"Martinez\",\"Matthews and White\",\"Meadows\",\"Melanippe GmbH & Co. KG\",\"Merritt-Austin\",\"Montes\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Norwegian Fjord  S.A. de C.V. Brothers\",\"Náutica del Mar GmbH & Co. KG\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Phillips and Moody\",\"Playa de Arena Ltd. Liability Co\",\"Playa de la Luna Starfish\",\"Portuguese Sea Bass & N.V. Logistics\",\"Punjab  Market Ltd. Liability Co Brothers\",\"Punjab s Pic Express\",\"Reese\",\"Reyes-Kelly\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Rufiji Delta  Limited Liability Company\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"Sea Striders Kelp BV Solutions\",\"SeaSelect Foods Salt spray\",\"SeaSolutions Dry dock OJSC Transit\",\"SeaSolutions Leska Kga Worldwide\",\"Seashell Sanctum Co Family\",\"Selkie GmbH Marine life\",\"Shepherd and Phillips\",\"SilverScales Ltd. Liability Co\",\"Simon and Farmer\",\"Singleton Ltd\",\"Smith and Harrison\",\"Smith and Scott\",\"Spanish Shrimp A/S Marine\",\"Sullivan\",\"Taylor\",\"Thetis Ltd. Liability Co\",\"Thompson\",\"TideTurner Tidepool Co Enterprises\",\"Tucker-Turner\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Uttar Pradesh Sea  United\",\"Velazquez-Harris\",\"Vespuci Sandbar Sp Brothers\",\"Walker-Lozano\",\"Webb and Martin\",\"Werner-Ortiz\",\"West Bengal  Co _\",\"West Fish  GmbH Transport\",\"Wise and Fuentes\",\"Wright LLC\",\"Young and Ramos\",\"hǎi mǎ S.p.A. Transport\",\"hǎi zhé S.A. de C.V.\",\"jīn qiāng yú AG\",\"mán yú BV Coral Reef\"],\"type.x\":[\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\"],\"weights\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,3,1,1,1,1,1,1,1,3,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,3,1,1,1,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"color\":{\"background\":\"pink\",\"border\":\"red\"},\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\",\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Companies that have registered in multiple countries\n\nWhile it is true that companies are typically registered in the country where they are headquartered or where they conduct their primary operations, it is not unheard of for companies to be registered in multiple countries. Nevertheless for our visualisation, we wish to identify such companies as such situations may not be entirely normal and these companies may potentially breach some form of legality.\n\nThe bar chart below shows the companies that have registered in more than one country. It reveals that Aqua Aura SE marine Life has the highest number of countries it registers in (8 countries in total). This is followed by Transit Limited Liability Company as well as Tamil Nadu S A/S, with both registered in 4 countries each.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Derive specific edge table and filter all companies\nmc3_edges_country <- mc3_edges_bysource %>%\n  select (source, country, type.y) %>%\n  group_by(source) %>%\n  filter(type.y == \"Company\") %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter companies that are registered in more than 1 country\nmc3_edges_country_filtered_one <- subset(mc3_edges_country, ave(source, source, FUN = length) > 1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_edges_country_filtered_one, aes(x = source)) +\n  geom_bar(fill = \"lightblue\") +\n  coord_flip() +\n  xlab(\"Companies\") +\n  ylab(\"No of countries registered\") +\n  scale_y_continuous(breaks = pretty_breaks(n = 5)) +\n  theme(axis.text.y = element_text(size = 4))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nTo gather deeper insights, we will drill down to more extreme cases to uncover deeper insights on such companies. The visualisation below focuses on companies which are registered in more than 2 countries. From the network plot, we can pick up the countries that the company registers in. In the case of Aqua Aura SE Marine Life, this company has registered in 8 countries - Oceanus, Coralmarica, Alverossia, Nalakond, Rio Isla, Talandria, Icarnia and Isliandor.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter companies that are registered in more than 2 countries\nmc3_edges_country_filtered <- subset(mc3_edges_country, ave(source, source, FUN = length) > 2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create corresponding nodes table out of the edges table\nid1_con <- mc3_edges_country_filtered %>%\n  select(source) %>%\n  rename(id = source)\nid2_con <- mc3_edges_country_filtered %>%\n  select(country) %>%\n  rename(id = country)\nmc3_nodes_country_filtered <- rbind(id1_con, id2_con) %>%\n  distinct()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#prep format for plotting\nmc3_edges_country_filtered <- mc3_edges_country_filtered %>%\nrename(from = source) %>%\nrename(to = country) %>%\nfilter(from!=to) %>%\nungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Plot interactive graph\nvisNetwork(mc3_nodes_country_filtered, mc3_edges_country_filtered) %>%\n  visNodes(color = list(background = \"lightgreen\", border = \"orange\")) %>%\n  visEdges(arrows = \"from\") %>%\n  visIgraphLayout(layout = \"layout_with_gem\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-a2778e0bacd59982918e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a2778e0bacd59982918e\">{\"x\":{\"nodes\":{\"id\":[\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Zawalinda\",\"Gavanovia\",\"Kondarivakia\",\"Faraluna\",\"Kondanovia\",\"Puerto del Mar\",\"Puerto Sol\",\"Kethilim\",\"Sol y Oceana\",\"Osterivaro\",\"Thessalandia\",\"Brindisola\"],\"x\":[-0.0483482988021329,-0.768357971466571,0.41318336956403,0.162195265475642,-0.543648830808777,-0.195558963190062,-0.392169003995763,-0.642918584444175,-0.33239360955165,-0.109977825721249,0.649102025922302,0.0543538352549482,-0.272816926700883,0.107244144214392,0.725870381427812,-0.434641642904341,0.164180878572059,0.189750340557691,-0.235286142956556,0.320880236371782,0.148129643918492,0.270981008388028,-0.181285436888224,-0.0685250172278282,-1,-0.52897783059553,0.137646290527685,-0.19819588703214,0.287072491321207,-0.817476093391969,-0.856404934262456,-0.921228243848406,-0.312515489385292,-0.452363562005335,0.913382099443477,0.825837365630721,-0.40937625180754,-0.278643095102999,0.975420734250769,1],\"y\":[-0.0786154120823765,-0.60389681927287,-0.505926143829382,0.420052244317829,-0.00767491538411413,-0.502189530511381,0.305748558399957,0.191314210770343,-0.639202479379859,-0.323190324063292,0.333712198565475,0.20563562601108,0.659329770473912,-0.317251321367818,-0.118247703873003,-0.356311796439322,0.0815389724381417,-0.129188261093422,-0.0927163965308317,0.00893498897385081,-0.53496714400489,-0.309072202432734,0.419576204017316,0.208292016318814,-0.776314915208764,-0.727645971407129,-0.757605295668336,0.10373350832223,0.733892803940118,-0.0501632890101172,0.425143852421723,0.275545395080458,-1,-0.964762004967214,0.442583642531319,0.583647916649734,0.967646501988849,1,-0.27083012836393,-0.0890439111591211],\"label\":[\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Zawalinda\",\"Gavanovia\",\"Kondarivakia\",\"Faraluna\",\"Kondanovia\",\"Puerto del Mar\",\"Puerto Sol\",\"Kethilim\",\"Sol y Oceana\",\"Osterivaro\",\"Thessalandia\",\"Brindisola\"]},\"edges\":{\"from\":[\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bahía del Sol Corporation\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Bay of Bengal's Ltd. Liability Co\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu  BV Logistics\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Diao yu bi sai  BV\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Jammu S.A. de C.V.\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Manipur  Market Ltd. Liability Co\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar de Coral ОАО\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Mar del Paraíso GmbH\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Océano del Este Co\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Perla del Mar Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Solutions Limited Liability Company\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Yenisei  Eel GmbH & Co. KG Services\"],\"to\":[\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Mawazam\",\"Coralmarica\",\"Korvelonia\",\"Nalakond\",\"Nalakond\",\"Marebak\",\"Zawalinda\",\"Oceanus\",\"Marebak\",\"Gavanovia\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Oceanus\",\"Marebak\",\"Isliandor\",\"Kondarivakia\",\"Oceanus\",\"Faraluna\",\"Oceanus\",\"Kondanovia\",\"Puerto del Mar\",\"Oceanus\",\"Marebak\",\"Coralmarica\",\"Puerto Sol\",\"Nalakond\",\"Kethilim\",\"Nalakond\",\"Marebak\",\"Oceanus\",\"Marebak\",\"Isliandor\",\"Sol y Oceana\",\"Osterivaro\",\"Nalakond\",\"Oceanus\",\"Alverossia\",\"Coralmarica\",\"Thessalandia\",\"Brindisola\",\"Nalakond\"],\"type.y\":[\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"color\":{\"background\":\"lightgreen\",\"border\":\"orange\"},\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"from\",\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Word cloud on product services\n\nThe word cloud provides an overview of the range of product services provided by the companies. It also provides us with an indication of the more common business groups and the product mix.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncolumn_values <- mc3_edges_toprevenue$product_services\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create a Corpus\ncorpus <- Corpus(VectorSource(column_values))\n\n#Preprocess the words\ncorpus <- tm_map(corpus, content_transformer(tolower))\ncorpus <- tm_map(corpus, removePunctuation)\ncorpus <- tm_map(corpus, removeNumbers)\n\n#Add custom stopwords\ncustom_stopwords <- c(\"products\", \"systems\", \"including\", \"solutions\", \"industrial\", \"wide\", \"short\", \"fat\", \"die\", \"related\", \"equipment\", \"range\", \"offers\", \"kits\", \"frozen\", \"wild\", \"kit\", \"soft\", \"hard\", \"non\", \"cooked\", \"ltl\", \"dust\", \"full\", \"processing\", \"high\", \"dried\", \"far\", \"low\", \"roll\", \"flat\", \"raw\", \"source\", \"lcl\", \"men\", \"strip\", \"include\", \"multi\", \"natural\", \"general\", \"unit\", \"care\", \"hot\", \"rare\", \"dry\", \"set\", \"provides\", \"involved\", \"ends\", \"chum\", \"freelance\", \"hvac\", \"etc\")\ncorpus <- tm_map(corpus, removeWords, stopwords(\"english\"))\ncorpus <- tm_map(corpus, removeWords, custom_stopwords)\n\n#Create a term document matrix\ntdm <- TermDocumentMatrix(corpus)\n\n#Convert the term document matrix to a matrix\nm <- as.matrix(tdm)\n\n#Calculate word frequencies\nword_freq <- sort(rowSums(m), decreasing = TRUE)\n\n#Create the word cloud\nwordcloud(words = names(word_freq), freq = word_freq, scale = c(5, 1), random.order = FALSE, colors = brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}