{
  "hash": "29e696d0396f9491f7501d98151f4152",
  "result": {
    "markdown": "---\ntitle: \"Take-Home Exercise 3\"\nauthor: \"Hin Phung\"\ndate: \"9 Jun 2023\"\ndate-modified: \"2023-06-16\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\neditor: visual\n---\n\n\n# Overview\n\n### Introduction\n\nThe country of Oceanus has sought FishEye International's help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye's analysts had received import/export data for Oceanus' marine and fishing industries, but the data is incomplete. FishEye had subsequently transformed the trade data into a knowledge graph to help them understand the business relationships, including finding links that will stop IUU fishing and protect marine species.\n\nWe will address Question 1 of VAST challenge 2023 MC3 - To Use visual analytics to identify anomalies in the business groups present in the knowledge graph\n\n### Methodology\n\nTo use different visualisation techniques to identify relationships and anomalies of entities in the businesss groups.\n\n### Data Preparation\n\n#### Installing and loading of R packages\n\nThe code chunk below will be used to install and load the necessary R packages as follows:\n\n-   jsonlite: a package supports both reading and writing JSON files, as well as working with JSON data retrieved from web APIs.\n\n-   igraph: a package in R that offers a wide range of tools for creating, manipulating, and visualizing graphs, as well as various algorithms and metrics for network analysis.\n\n-   tidygraph: provides a tidy and consistent approach to working with graph data using the principles of the tidyverse\n\n-   ggraph: an extension package in R that builds upon the tidygraph and ggplot2 packages. It provides a high-level interface for creating visualizations of graph data using the grammar of graphics approach.\n\n-   viznetwork: a package provides geoms for ggplot2 to repel overlapping text labels.\n\n-   graphlayouts: a package that provides a collection of layout algorithms that can be used to visualize graphs.\n\n-   ggforce: extension package for ggplot2 that provides additional functionalities and extensions to enhance and expand the capabilities of ggplot2 for data visualization.\n\n-   tidyverse: a family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.\n\n-   scales: package that provides various functions for scaling and formatting data, primarily for data visualization purposes.\n\n-   wordcloud: package for creating word clouds, which are visual representations of textual data where the size of each word corresponds to its frequency or importance in the text.\n\n-   tm: text mining package that provides tools for text preprocessing, document-term matrix creation, and various other text mining tasks.\n\n-   treemap: a package that allows you to create treemaps, which are visualizations that display hierarchical data as nested rectangles.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npacman::p_load(jsonlite, tidygraph, ggraph, \n               visNetwork, graphlayouts, ggforce, \n               skimr, tidytext, tidyverse, scales, wordcloud, tm, treemap)\n```\n:::\n\n\n# The Data\n\nThe function fromJSON() of jsonlite package is used to import mc3.json into R environment. The data comprises:\n\n-   list of 27622 \"nodes\" with 5 columns (id, country, type, revenue_omu, project_services)\n\n-   list of 24038 \"links\" with 3 columns (source, target, type)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_data <- fromJSON(\"data/MC3.json\")\n```\n:::\n\n\n# Data Preparation\n\nThe list of \"links\" are extracted to form an edge table. Correspondingly, the list of \"nodes\" are extracted to form a nodes table.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Extract edges from the list\nmc3_edges <- as_tibble(mc3_data$links) %>% \n  distinct() %>%\n  mutate(source = as.character(source),\n         target = as.character(target),\n         type = as.character(type)) %>%\n  group_by(source, target, type) %>%\n    summarise(weights = n()) %>%\n  filter(source!=target) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Extract nodes from the list\nmc3_nodes <- as_tibble(mc3_data$nodes) %>%\n  mutate(country = as.character(country),\n         id = as.character(id),\n         product_services = as.character(product_services),\n         revenue_omu = as.numeric(as.character(revenue_omu)),\n         type = as.character(type)) %>%\n  select(id, country, type, revenue_omu, product_services)\n```\n:::\n\n\n# Data Exploration\n\n### Exploring edge table\n\nWe first explore the created edge table. The report below reveals that there are not missing values in all fields.We also made comparison between Different types in the edge table. The bar graph below indicates that there are 2 types of entities in the edge table - company contacts and owners.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskim(mc3_edges)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |mc3_edges |\n|Number of rows           |24036     |\n|Number of columns        |4         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |3         |\n|numeric                  |1         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|source        |         0|             1|   6| 700|     0|    12856|          0|\n|target        |         0|             1|   6|  28|     0|    21265|          0|\n|type          |         0|             1|  16|  16|     0|        2|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate| mean| sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|----:|--:|--:|---:|---:|---:|----:|:-----|\n|weights       |         0|             1|    1|  0|  1|   1|   1|   1|    1|▁▁▇▁▁ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_edges, aes(x = type, fill = type)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Exploring nodes table\n\nSimilarly, we explore the created nodes table. The report above reveals that there are 21515 missing values under \"revenue_omu\" column and these rows will be subsequently removed when visualising the revenues of the companies. The bar graph comparing the types of entities in the nodes table reveal that there are 3 types of entities - company, company contacts and owners.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nskim(mc3_nodes)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |mc3_nodes |\n|Number of rows           |27622     |\n|Number of columns        |5         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |4         |\n|numeric                  |1         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable    | n_missing| complete_rate| min|  max| empty| n_unique| whitespace|\n|:----------------|---------:|-------------:|---:|----:|-----:|--------:|----------:|\n|id               |         0|             1|   6|   64|     0|    22929|          0|\n|country          |         0|             1|   2|   15|     0|      100|          0|\n|type             |         0|             1|   7|   16|     0|        3|          0|\n|product_services |         0|             1|   4| 1737|     0|     3244|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|       sd|      p0|     p25|      p50|      p75|      p100|hist  |\n|:-------------|---------:|-------------:|-------:|--------:|-------:|-------:|--------:|--------:|---------:|:-----|\n|revenue_omu   |     21515|          0.22| 1822155| 18184433| 3652.23| 7676.36| 16210.68| 48327.66| 310612303|▇▁▁▁▁ |\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_nodes, aes(x = type, fill = type)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Data Wrangling\n\nWe would need to extract the embedded lists of entities found under the \"Source\" column in the original edges table, and itemise into individual rows. This is done by splitting the string in the embedded lists into edges sub-table, and removing whitespaces and irrelevant characters.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Extract lists from the edges table\nmc3_edge_unclean <- mc3_edges %>%\n  filter(substr(source,1,2) %in% \"c(\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Break up the lists in the edge file by splitting the string\nmc3_edge_broken <- unnest(mc3_edge_unclean, source = strsplit(as.character(source), \"\\\\(|\\\\,|\\\\)\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Remove whitespaces amd filter records with \"c\" value\n#Create edges table incorporating the unlisted values\nmc3_edge_broken <- mc3_edge_broken %>%\n  mutate(source = gsub(\"\\\"\", \"\", source)) %>%\n  filter(source !=\"c\") %>%\n  mutate(source = trimws(source)) %>%\n  mutate(target = trimws(target)) %>%\n  group_by(source, target, type) %>%\n  summarise(weights = n()) %>%\n  filter(source != target) %>%\n  ungroup()\n```\n:::\n\n\nFrom the original edges table, we will remove the lists, and subsequently concatenate the itemised values which were extracted from the embedded lists. This will form the clean edges table.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create edges table without embedded lists from original edges table\nmc3_edges_without_list <- mc3_edges %>%\n  filter(!substr(source,1,2) %in% \"c(\") %>%\n  distinct()\n\n#Combine new edges table with edges table incorporated with the unlisted values, to form a combined edges table.  \nmc3_edges_combined <- rbind(mc3_edges_without_list, mc3_edge_broken)\n```\n:::\n\n\nNext we will join the edges table with nodes table into combined edge table by mapping edge \"source\" column in edge table with \"id\" column in nodes table. This will provide us with the information on the type of \"source\" entities in the edges table. The edges table will be used to derive the data for subsequent visualisation.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_bysource <- left_join(mc3_edges_combined, mc3_nodes,\n                               by = c(\"source\" = \"id\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Rename relevant columns as \"source type\" and \"target type\"\n#Filter combined edge table by removing unknown and NA values from relevant columns.\nmc3_edges_bysource1 <- mc3_edges_bysource %>%\n  group_by(source, target, type.y, type.x, country, weights, revenue_omu, product_services) %>%\n  filter(source!=target) %>%\n  rename(source_type = type.y) %>%\n  rename(target_type = type.x) %>%\n  filter(product_services != \"Unknown\") %>%\n  filter(product_services != \"character(0)\") %>%\n  ungroup()\n```\n:::\n\n\n# Visualisation\n\n### Countries registered by top revenue companies\n\nThe treemap is constructed based on the top 50 companies that generates the highest revenues. It is observed that, of the top 50 companies with the highest revenues, almost half of the total revenues are earned by companies registered in ZH country. The 2 highest earning companies are Jones LLC and Patton Ltd. The diagram also revealed that Assam Limited Liability Company and Aqua Advancements Sashimi SE Express are the highest earning company in Utoporiana country and Oceanus country respectively.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Derive new edge table\nmc3_edges_toprevenue <- mc3_edges_bysource1 %>%\n  select (source, source_type, country, weights, revenue_omu, product_services) %>%\n  group_by(source) %>%\n  arrange(desc(revenue_omu)) %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter top 50 companies with highest revenues\nmc3_edges_toprevenue_filtered <- mc3_edges_toprevenue %>%\n  filter (source_type == \"Company\") %>%\n  slice_max(order_by = revenue_omu, n = 50)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Construct treemap\ntreemap(mc3_edges_toprevenue_filtered,\n        index=c(\"country\", \"source\"),\n        vSize=\"revenue_omu\",\n        vColor=\"revenue_omu\",\n        title=\"Revenue by Country and Company\",\n        title.legend = \"revenue of company\"\n        )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Individual owners with multiple companies\n\nOne of the anormalies that we can detect is the number of companies the individual entities own. We can be suspicious of these individuals if they own an exceptionally high number of companies.\n\nIn this visualisation on individuals who own more than 5 companies, we observe that the individual who owns the largest number of companies is John Smith (owns a total of 11 companies). This is followed by Micheal Johnson and Jennifer Smith who owns 9 and 8 companies respectively. We can also infer that this group of owners are dominated by the presence of the Smith family.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter individual owners from edge table, and assign target to be source and vice versa\nmc3_edges_indivowners <- mc3_edges_bysource %>%\n  select (target, source, type.x, weights) %>%\n  group_by(target) %>%\n  filter(type.x == \"Beneficial Owner\") %>%\n  rename (sc = target) %>%\n  rename (tg = source) %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter individuals who own more 5 companies\nmc3_edges_indivowners_filtered <- mc3_edges_indivowners %>%\n  group_by(sc) %>%\n  filter(n() > 5) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create corresponding nodes table out of the edges table\nid1_inv <- mc3_edges_indivowners_filtered %>%\n  select(sc) %>%\n  rename(id = sc)\nid2_inv <- mc3_edges_indivowners_filtered %>%\n  select(tg) %>%\n  rename(id = tg)\nmc3_nodes_indivowners_filtered <- rbind(id1_inv, id2_inv) %>%\n  distinct()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#prep format for plotting\nmc3_edges_indivowners_filtered <- mc3_edges_indivowners_filtered %>%\nrename(from = sc) %>%\nrename(to = tg) %>%\n#filter (target_type == \"companies\") %>%\nfilter(from!=to) %>%\nungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Plot interactive graph\nvisNetwork(mc3_nodes_indivowners_filtered, mc3_edges_indivowners_filtered) %>%\n  visNodes(color = list(background = \"pink\", border = \"red\")) %>%\n  visEdges(arrows = \"to\") %>%\n  visIgraphLayout(layout = \"layout_with_gem\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-5ae7d8d1be3438fd00e4\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5ae7d8d1be3438fd00e4\">{\"x\":{\"nodes\":{\"id\":[\"Richard Smith\",\"John Smith\",\"David Jones\",\"Michael Bell\",\"Michael Johnson\",\"David Thomas\",\"Michael Williams\",\"Ashley Harris\",\"Jennifer Smith\",\"James Smith\",\"Lisa Johnson\",\"Jennifer Taylor\",\"Anna Wheeler\",\"John Williams\",\"Acevedo, Dickson and Gonzalez\",\"Adams Group\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Aqua Aura SE Marine life\",\"Arnold, Wise and Fuentes\",\"Baker and Sons\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chavez PLC\",\"Chen, Jones and Davis\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis, Webb and Martin\",\"Dean-Fisher\",\"Faroe Islands  Company World\",\"Garcia, Ferguson and Miller\",\"Garcia, Smith and Scott\",\"Guzman-Chang\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hancock Inc\",\"Jacobs-Henry\",\"Jones, Kennedy and Johnson\",\"Knight-Brown\",\"Kong zhong diao yu  GmbH\",\"Lang, Garcia and Harris\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Merritt-Austin\",\"Miller, Wiggins and Smith\",\"Montes, Kidd and Hall\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Peterson PLC\",\"Playa de la Luna Starfish\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Ryan-Curry\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"SeaBass  Leska N.V. International\",\"SeaSolutions Dry dock OJSC Transit\",\"Seashell Seekers ОАО International\",\"Singleton Ltd\",\"Spanish Shrimp A/S Marine\",\"Sullivan, Simon and Farmer\",\"Taylor, Choi and Merritt\",\"The Salted Pearl Inc Pelican\",\"Thetis Ltd. Liability Co\",\"Thompson LLC\",\"Thompson, Shepherd and Phillips\",\"TideTurner Tidepool Co Enterprises\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Velazquez-Harris\",\"Walker-Lozano\",\"Wright LLC\",\"hǎi zhé Herring Incorporated Logistics\",\"hǎi zhé S.A. de C.V.\",\"mán yú BV Coral Reef\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Aqua Adventures Ltd. Corporation\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Beachcombers Nautical Plc Carriers\",\"Brisa del Mar GmbH\",\"Dutch Mussels S.p.A. Sea spray\",\"Karelians Plc Marine conservation\",\"Kerala  Market Oyj Freight\",\"Ltd. Corporation Ltd. Corporation\",\"Maacama  S.p.A. Marine ecology\",\"Mar de Cristal S.A. de C.V.\",\"Marine Muse Pic Marine ecology\",\"Melanippe GmbH & Co. KG\",\"Náutica del Mar GmbH & Co. KG\",\"Oka  S.A. de C.V.\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Punjab s Pic Express\",\"Rufiji Delta  Limited Liability Company\",\"Sea Striders Kelp BV Solutions\",\"SeaSolutions Leska Kga Worldwide\",\"SeaSplash Foods Corporation Freight\",\"jīn qiāng yú AG\"],\"x\":[-0.580886698537419,-0.0384733482792988,-0.68862080364646,0.519756813184589,0.0235888029201139,0.132144006259278,0.241399022138038,-0.325223237407633,-0.210391748894578,0.435570131022215,-0.737417185124209,0.717519399605896,-0.187807464383613,0.0696415870589453,-0.664381035640912,-0.263234580098498,-0.974128882814863,-0.922584028569499,0.768136783159535,-0.831105624085804,-0.0624379706867153,0.324037230665201,0.654142213792089,0.470914818403975,-0.387227647139969,0.318543662271454,-0.831730386788334,0.258909134423676,-0.935904421294714,-0.378861689753869,0.444954233443503,-0.48577623911069,0.595732148866546,-0.124419879938889,-0.889832475598276,0.39686928471396,-0.158766615934689,0.708908015717167,-0.43772138690334,0.260514234543017,0.708611847828385,0.227466379524577,0.164560091545411,-0.939400091305724,1,0.762964472439221,-0.9896269987858,-0.446850779024868,-0.926469668170389,-0.241324242707754,-0.87106527280063,-0.457225732939811,-0.446156755917269,-0.106520079575459,0.235779863175516,-0.281791990216139,0.675208400940013,0.173067268401322,0.0549246301998207,0.246042517760423,-0.200685049350722,0.988806128216394,-0.922557884359801,-1,0.275643455283739,0.0766812565394086,0.481209393471691,-0.966547654032285,0.0776812254209227,0.190552657155269,0.156052060251069,0.967257561706179,0.609947964170851,0.109890535363244,0.664562988637342,-0.202315075359741,0.234100095234519,0.0074507752338222,0.986304910365056,-0.729872140748635,0.0498810056574632,-0.760194047997938,-0.997156263729346,0.385303866063682,0.641684888994621,-0.52800597614026,0.0205668832741566,-0.791763793072644,0.696320807855263,0.218456970280987,-0.163698110032341,-0.24629342004655,-0.260605921293414,-0.438500857900119,-0.36813627380483,0.133840086505401,0.153211095998018,0.692380587250579,-0.30382234415609,-0.350607105350186,0.120961838055375,0.949284043493413,-0.224279391589346,-0.051163136243462,0.273678262985196,-0.299849865464195,0.728240468250062,-0.3840615545992,0.920730513039523,-0.0175668800847275,0.143864395880683,-0.351633678188364],\"y\":[-0.364426961020283,0.0351244664008585,-0.0569658684553256,0.527738199846958,0.12992853758938,-0.724824895502392,-0.299555601607786,0.73090273681955,0.208324933991906,-0.050218166593704,0.37080573614797,0.243922082243403,-0.356417670527871,0.534626095452876,-0.599722814087296,0.0237892491992064,-0.112186847621234,-0.0782712646959115,0.643982156873299,-0.422302041107243,0.294364811361247,-0.904711465482404,0.7487617924859,-0.379178272671093,0.935083879304305,-0.530804720598,-0.488653255078027,0.138761807744487,-0.161593469490593,0.402113931124253,-0.495870119289097,0.925424460553857,0.759911203696659,-0.167650457839152,-0.203055455946885,-0.450893807639966,-0.0578134301344189,-0.089204535940449,0.142066536776061,0.1981822842289,-0.145184128273799,0.276488187975996,0.2389648065648,0.542688195258648,0.25916240582652,0.589205621883509,0.343681485572384,0.270327754305059,0.485207806125145,0.431332732253886,0.567306305607933,0.212895128275731,0.345049105353986,-0.570677743990681,0.0645162517793132,0.971411468348501,-0.211615797454752,-0.954428102609091,-0.966818700989125,-0.526280864134855,-0.13302042031163,0.349878910259244,0.0219797764550886,0.409183023779887,-0.951645480016295,-0.126333987026958,-0.44353497102382,-0.0307193421121992,0.323195862840074,0.768165735326431,0.319595593599813,0.14183599800122,-0.227124800380489,0.803956240122825,0.0242473919403738,0.0961549654660732,0.724237262582222,0.338243530482794,0.200658208970619,-0.580803081779258,0.777795420537713,-0.503797861057218,0.467553247959636,-0.530237265142144,-0.140386131455021,0.875251058821825,-0.179195451161678,-0.560912260594338,-0.040061097209921,-0.975950476560345,-0.60448438047104,-0.55346747234249,-0.0572346069884734,0.970639307139558,0.330886103104289,0.730561412104735,-0.0130154684315311,0.671069166482246,0.419866827775785,1,-1,0.295780300191191,-0.627271731964819,-0.161675545869461,0.680093861052482,-0.598304349280164,0.719336562879545,-0.485335567209908,0.389226637819547,0.754546676028246,-0.092296191408864,-0.556400160196137],\"label\":[\"Richard Smith\",\"John Smith\",\"David Jones\",\"Michael Bell\",\"Michael Johnson\",\"David Thomas\",\"Michael Williams\",\"Ashley Harris\",\"Jennifer Smith\",\"James Smith\",\"Lisa Johnson\",\"Jennifer Taylor\",\"Anna Wheeler\",\"John Williams\",\"Acevedo, Dickson and Gonzalez\",\"Adams Group\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Aqua Aura SE Marine life\",\"Arnold, Wise and Fuentes\",\"Baker and Sons\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chavez PLC\",\"Chen, Jones and Davis\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis, Webb and Martin\",\"Dean-Fisher\",\"Faroe Islands  Company World\",\"Garcia, Ferguson and Miller\",\"Garcia, Smith and Scott\",\"Guzman-Chang\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hancock Inc\",\"Jacobs-Henry\",\"Jones, Kennedy and Johnson\",\"Knight-Brown\",\"Kong zhong diao yu  GmbH\",\"Lang, Garcia and Harris\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Merritt-Austin\",\"Miller, Wiggins and Smith\",\"Montes, Kidd and Hall\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Peterson PLC\",\"Playa de la Luna Starfish\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Ryan-Curry\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"SeaBass  Leska N.V. International\",\"SeaSolutions Dry dock OJSC Transit\",\"Seashell Seekers ОАО International\",\"Singleton Ltd\",\"Spanish Shrimp A/S Marine\",\"Sullivan, Simon and Farmer\",\"Taylor, Choi and Merritt\",\"The Salted Pearl Inc Pelican\",\"Thetis Ltd. Liability Co\",\"Thompson LLC\",\"Thompson, Shepherd and Phillips\",\"TideTurner Tidepool Co Enterprises\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Velazquez-Harris\",\"Walker-Lozano\",\"Wright LLC\",\"hǎi zhé Herring Incorporated Logistics\",\"hǎi zhé S.A. de C.V.\",\"mán yú BV Coral Reef\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Aqua Adventures Ltd. Corporation\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Beachcombers Nautical Plc Carriers\",\"Brisa del Mar GmbH\",\"Dutch Mussels S.p.A. Sea spray\",\"Karelians Plc Marine conservation\",\"Kerala  Market Oyj Freight\",\"Ltd. Corporation Ltd. Corporation\",\"Maacama  S.p.A. Marine ecology\",\"Mar de Cristal S.A. de C.V.\",\"Marine Muse Pic Marine ecology\",\"Melanippe GmbH & Co. KG\",\"Náutica del Mar GmbH & Co. KG\",\"Oka  S.A. de C.V.\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Punjab s Pic Express\",\"Rufiji Delta  Limited Liability Company\",\"Sea Striders Kelp BV Solutions\",\"SeaSolutions Leska Kga Worldwide\",\"SeaSplash Foods Corporation Freight\",\"jīn qiāng yú AG\"]},\"edges\":{\"from\":[\"Richard Smith\",\"John Smith\",\"David Jones\",\"David Jones\",\"Michael Bell\",\"Richard Smith\",\"Michael Johnson\",\"David Thomas\",\"Michael Bell\",\"Michael Williams\",\"Ashley Harris\",\"Michael Williams\",\"Richard Smith\",\"Michael Johnson\",\"David Jones\",\"Jennifer Smith\",\"Michael Williams\",\"Ashley Harris\",\"Michael Bell\",\"John Smith\",\"David Jones\",\"Michael Williams\",\"John Smith\",\"James Smith\",\"Jennifer Smith\",\"Michael Johnson\",\"James Smith\",\"Michael Johnson\",\"Michael Johnson\",\"Lisa Johnson\",\"Jennifer Taylor\",\"Michael Bell\",\"Lisa Johnson\",\"Jennifer Smith\",\"Lisa Johnson\",\"Jennifer Smith\",\"Lisa Johnson\",\"Jennifer Smith\",\"Jennifer Smith\",\"Anna Wheeler\",\"Michael Johnson\",\"Ashley Harris\",\"James Smith\",\"David Thomas\",\"David Thomas\",\"Michael Williams\",\"John Smith\",\"Jennifer Taylor\",\"David Jones\",\"Lisa Johnson\",\"David Thomas\",\"John Smith\",\"Michael Williams\",\"David Jones\",\"Michael Johnson\",\"John Williams\",\"Michael Johnson\",\"Jennifer Taylor\",\"James Smith\",\"John Williams\",\"James Smith\",\"John Smith\",\"John Williams\",\"Michael Johnson\",\"Jennifer Taylor\",\"Richard Smith\",\"John Williams\",\"Richard Smith\",\"Lisa Johnson\",\"Michael Williams\",\"James Smith\",\"Ashley Harris\",\"John Smith\",\"Richard Smith\",\"James Smith\",\"David Thomas\",\"Anna Wheeler\",\"Anna Wheeler\",\"John Smith\",\"Ashley Harris\",\"Jennifer Smith\",\"John Williams\",\"John Smith\",\"Michael Bell\",\"Jennifer Smith\",\"Ashley Harris\",\"David Thomas\",\"Jennifer Taylor\",\"Anna Wheeler\",\"John Smith\",\"John Williams\",\"Anna Wheeler\",\"Michael Bell\",\"Anna Wheeler\",\"Jennifer Taylor\",\"John Williams\",\"John Smith\",\"Anna Wheeler\"],\"to\":[\"Acevedo, Dickson and Gonzalez\",\"Adams Group\",\"Adriatic Catch S.A. de C.V.\",\"Alexander PLC\",\"Aqua Aura SE Marine life\",\"Arnold, Wise and Fuentes\",\"Baker and Sons\",\"BlueTide GmbH & Co. KG\",\"Brewer Inc\",\"Brown-Evans\",\"Byrd-Flores\",\"Carter LLC\",\"Chavez PLC\",\"Chen, Jones and Davis\",\"Congo Rapids   AG Sea spray\",\"Cortez Group\",\"Costa de Coral Kga\",\"Davis, Webb and Martin\",\"Dean-Fisher\",\"Faroe Islands  Company World\",\"Garcia, Ferguson and Miller\",\"Garcia, Smith and Scott\",\"Guzman-Chang\",\"Hall-Taylor\",\"Hamilton LLC\",\"Hancock Inc\",\"Jacobs-Henry\",\"Jones, Kennedy and Johnson\",\"Knight-Brown\",\"Kong zhong diao yu  GmbH\",\"Lang, Garcia and Harris\",\"Limpopo River  Ltd. Liability Co\",\"Lloyd-Russell\",\"Luangwa River   Limited Liability Company Holdings\",\"Lucas-Shelton\",\"Mar de Coral GmbH and Son's\",\"Mar de Cristal Ltd Abalone\",\"Mar de Cristal ОАО\",\"Mar del Oeste -\",\"Merritt-Austin\",\"Miller, Wiggins and Smith\",\"Montes, Kidd and Hall\",\"Murphy-Russell\",\"Nagaland Sea Catch Ltd. Liability Co Logistics\",\"Ocean Quest S.A. de C.V.\",\"Océano del Este Eel\",\"Peterson PLC\",\"Playa de la Luna Starfish\",\"Rogers-Robinson\",\"Romero Ltd and Son's\",\"Rubio-Evans\",\"Ryan-Curry\",\"Sanchez PLC\",\"Sander Ltd. Liability Co Solutions\",\"SeaBass  Leska N.V. International\",\"SeaSolutions Dry dock OJSC Transit\",\"Seashell Seekers ОАО International\",\"Singleton Ltd\",\"Spanish Shrimp A/S Marine\",\"Sullivan, Simon and Farmer\",\"Taylor, Choi and Merritt\",\"The Salted Pearl Inc Pelican\",\"Thetis Ltd. Liability Co\",\"Thompson LLC\",\"Thompson, Shepherd and Phillips\",\"TideTurner Tidepool Co Enterprises\",\"Turkish Calamari LLC Shipping\",\"Turkish Calamari Plc ship\",\"Uttar Pradesh Sea  Ges.m.b.H. Industrial\",\"Velazquez-Harris\",\"Walker-Lozano\",\"Wright LLC\",\"hǎi zhé Herring Incorporated Logistics\",\"hǎi zhé S.A. de C.V.\",\"mán yú BV Coral Reef\",\"Andhra Pradesh  Limited Liability Company Ray\",\"Aqua Adventures Ltd. Corporation\",\"Baltic Sprat Ges.m.b.H. Enterprises\",\"Beachcombers Nautical Plc Carriers\",\"Brisa del Mar GmbH\",\"Dutch Mussels S.p.A. Sea spray\",\"Karelians Plc Marine conservation\",\"Kerala  Market Oyj Freight\",\"Ltd. Corporation Ltd. Corporation\",\"Maacama  S.p.A. Marine ecology\",\"Mar de Cristal S.A. de C.V.\",\"Marine Muse Pic Marine ecology\",\"Melanippe GmbH & Co. KG\",\"Náutica del Mar GmbH & Co. KG\",\"Oka  S.A. de C.V.\",\"Ola de la Costa AS\",\"PacificPlates S.A. de C.V.\",\"Punjab s Pic Express\",\"Rufiji Delta  Limited Liability Company\",\"Sea Striders Kelp BV Solutions\",\"SeaSolutions Leska Kga Worldwide\",\"SeaSplash Foods Corporation Freight\",\"jīn qiāng yú AG\"],\"type.x\":[\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\",\"Beneficial Owner\"],\"weights\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,3,2,1,1,2,1,1,2,1,1,3,1,2,1,1]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"color\":{\"background\":\"pink\",\"border\":\"red\"},\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\",\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Companies that have registered in multiple countries\n\nWhile it is true that companies are typically registered in the country where they are headquartered or where they conduct their primary operations, it is not unheard of for companies to be registered in multiple countries. Nevertheless for our visualisation, we wish to identify such companies as such situations may not be entirely normal and these companies may potentially breach some form of legality.\n\nThe bar chart below shows the companies that have registered in more than one country. It reveals that Aqua Aura SE marine Life has the highest number of countries it registers in (9 countries in total). This is followed by Transit Limited Liability Company as well as Tamil Nadu S A/S, with both registered in 4 countries each.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Derive specific edge table and filter all companies\nmc3_edges_country <- mc3_edges_bysource %>%\n  select (source, country, type.y) %>%\n  group_by(source) %>%\n  filter(type.y == \"Company\") %>%\n  distinct() %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter companies that are registered in more than 1 country\nmc3_edges_country_filtered_one <- mc3_edges_country %>%\n  group_by(source) %>%\n  filter(n() > 1) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggplot(data = mc3_edges_country_filtered_one, aes(x = source)) +\n  geom_bar(fill = \"lightblue\") +\n  coord_flip() +\n  xlab(\"Companies\") +\n  ylab(\"No of countries registered\") +\n  scale_y_continuous(breaks = pretty_breaks(n = 5)) +\n  theme(axis.text.y = element_text(size = 4))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\nTo gather deeper insights, we will drill down to more extreme cases to uncover deeper insights on such companies. The visualisation below focuses on companies which are registered in more than 2 countries. From the network plot, we can pick up the names of the countries that companies register in. In the case of Aqua Aura SE Marine Life, this company has registered in the 9 countries - Oceanus, Coralmarica, Alverossia, Nalakond, Rio Isla, Talandria, Icarnia, Mawazam and Isliandor.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Filter companies that are registered in more than 2 countries\nmc3_edges_country_filtered <- mc3_edges_country %>%\n  group_by(source) %>%\n  filter(n() > 2) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create corresponding nodes table out of the edges table\nid1_con <- mc3_edges_country_filtered %>%\n  select(source) %>%\n  rename(id = source)\nid2_con <- mc3_edges_country_filtered %>%\n  select(country) %>%\n  rename(id = country)\nmc3_nodes_country_filtered <- rbind(id1_con, id2_con) %>%\n  distinct()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#prep format for plotting\nmc3_edges_country_filtered <- mc3_edges_country_filtered %>%\nrename(from = source) %>%\nrename(to = country) %>%\nfilter(from!=to) %>%\nungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Plot interactive graph\nvisNetwork(mc3_nodes_country_filtered, mc3_edges_country_filtered) %>%\n  visNodes(color = list(background = \"lightgreen\", border = \"orange\")) %>%\n  visEdges(arrows = \"from\") %>%\n  visIgraphLayout(layout = \"layout_with_gem\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-06bd91404f238a7fbc39\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-06bd91404f238a7fbc39\">{\"x\":{\"nodes\":{\"id\":[\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Zawalinda\",\"Gavanovia\",\"Kondarivakia\",\"Faraluna\",\"Kondanovia\",\"Puerto del Mar\",\"Puerto Sol\",\"Kethilim\",\"Sol y Oceana\",\"Osterivaro\",\"Thessalandia\",\"Brindisola\"],\"x\":[0.104775660341486,0.773288577360129,-0.283041763849973,-0.064921997181449,0.639351066681141,0.339358172684607,0.491730869969784,0.0642538414118072,0.702320295706818,0.386577832074171,-0.699157237364678,0.0135575176926424,0.442896464130241,-0.046679115028665,-0.66154020752923,0.486353564420304,0.191462519581098,-0.104192712463948,0.236194052869977,-0.286630816719681,0.0769032275697685,-0.227207030163829,0.259984532562547,-0.137845395381517,0.981331830927851,0.57112869638537,0.00241622558660448,0.306699824004956,-0.174720965011237,0.940191434704424,0.0682235992030873,-0.0900584706712012,1,0.934039614476861,-0.932801654049474,-1,0.635019543767746,0.497182046829467,-0.949184405256425,-0.878998760998851],\"y\":[-0.0496243842377124,-0.788182903605426,-0.570807133507699,-0.372385834454284,-0.0306461538781878,-0.675401857266867,0.217654897486294,0.666755316283013,0.33862843345581,-0.287589255267449,-0.227816217001847,0.229196022574204,0.481382832935697,-0.170739984256687,0.216508183557697,-0.446018884590518,-0.324519745173099,0.203015989715949,0.122450096590374,-0.0462555683781655,-0.500708946514162,-0.226047406908521,0.385204447932979,0.0492963909882651,-0.997424010389925,-1,-0.876897567457325,-0.072888488913694,-0.689179083338965,-0.0928374722802862,1,0.95081136943208,0.408381062954486,0.569167483630621,-0.426501717323339,-0.243626946294029,0.754063483980827,0.817563843628922,0.273161285099359,0.443960253960967],\"label\":[\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Zawalinda\",\"Gavanovia\",\"Kondarivakia\",\"Faraluna\",\"Kondanovia\",\"Puerto del Mar\",\"Puerto Sol\",\"Kethilim\",\"Sol y Oceana\",\"Osterivaro\",\"Thessalandia\",\"Brindisola\"]},\"edges\":{\"from\":[\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Aqua Aura SE Marine life\",\"Bahía del Sol Corporation\",\"Bahía del Sol Corporation\",\"Bahía del Sol Corporation\",\"Bay of Bengal's Ltd. Liability Co\",\"Bay of Bengal's Ltd. Liability Co\",\"Bay of Bengal's Ltd. Liability Co\",\"Diao yu  BV Logistics\",\"Diao yu  BV Logistics\",\"Diao yu  BV Logistics\",\"Diao yu bi sai  BV\",\"Diao yu bi sai  BV\",\"Diao yu bi sai  BV\",\"Jammu S.A. de C.V.\",\"Jammu S.A. de C.V.\",\"Jammu S.A. de C.V.\",\"Manipur  Market Ltd. Liability Co\",\"Manipur  Market Ltd. Liability Co\",\"Manipur  Market Ltd. Liability Co\",\"Mar de Coral ОАО\",\"Mar de Coral ОАО\",\"Mar de Coral ОАО\",\"Mar del Paraíso GmbH\",\"Mar del Paraíso GmbH\",\"Mar del Paraíso GmbH\",\"Océano del Este Co\",\"Océano del Este Co\",\"Océano del Este Co\",\"Perla del Mar Co\",\"Perla del Mar Co\",\"Perla del Mar Co\",\"Solutions Limited Liability Company\",\"Solutions Limited Liability Company\",\"Solutions Limited Liability Company\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Tamil Nadu s A/S\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Transit Limited Liability Company\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Yenisei  Eel GmbH & Co. KG Services\",\"Yenisei  Eel GmbH & Co. KG Services\"],\"to\":[\"Mawazam\",\"Rio Isla\",\"Icarnia\",\"Oceanus\",\"Nalakond\",\"Coralmarica\",\"Alverossia\",\"Isliandor\",\"Talandria\",\"Novarcticaa\",\"Utoporiana\",\"Mawazam\",\"Coralmarica\",\"Korvelonia\",\"Nalakond\",\"Nalakond\",\"Marebak\",\"Zawalinda\",\"Oceanus\",\"Marebak\",\"Gavanovia\",\"Utoporiana\",\"Korvelonia\",\"Marebak\",\"Oceanus\",\"Marebak\",\"Isliandor\",\"Kondarivakia\",\"Oceanus\",\"Faraluna\",\"Oceanus\",\"Kondanovia\",\"Puerto del Mar\",\"Oceanus\",\"Marebak\",\"Coralmarica\",\"Puerto Sol\",\"Nalakond\",\"Kethilim\",\"Nalakond\",\"Marebak\",\"Oceanus\",\"Marebak\",\"Isliandor\",\"Sol y Oceana\",\"Osterivaro\",\"Nalakond\",\"Oceanus\",\"Alverossia\",\"Coralmarica\",\"Thessalandia\",\"Brindisola\",\"Nalakond\"],\"type.y\":[\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\",\"Company\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"color\":{\"background\":\"lightgreen\",\"border\":\"orange\"},\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"from\",\"smooth\":false},\"physics\":{\"stabilization\":false},\"layout\":{\"randomSeed\":123}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Word cloud on product services\n\nThe word cloud provides an overview of the range of product services provided by the companies. It also provides us with an indication of the more common business groups and the product mix. We can infer that most of the companies are dealing in food related services, in particular seafood and fish. In terms of the fish types, the salmon would seem to be the most common.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncolumn_values <- mc3_edges_toprevenue$product_services\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n#Create a Corpus\ncorpus <- Corpus(VectorSource(column_values))\n\n#Preprocess the words\ncorpus <- tm_map(corpus, content_transformer(tolower))\ncorpus <- tm_map(corpus, removePunctuation)\ncorpus <- tm_map(corpus, removeNumbers)\n\n#Add custom stopwords\ncustom_stopwords <- c(\"products\", \"systems\", \"including\", \"solutions\", \"industrial\", \"wide\", \"short\", \"fat\", \"die\", \"related\", \"equipment\", \"range\", \"offers\", \"kits\", \"frozen\", \"wild\", \"kit\", \"soft\", \"hard\", \"non\", \"cooked\", \"ltl\", \"dust\", \"full\", \"processing\", \"high\", \"dried\", \"far\", \"low\", \"roll\", \"flat\", \"raw\", \"source\", \"lcl\", \"men\", \"strip\", \"include\", \"multi\", \"natural\", \"general\", \"unit\", \"care\", \"hot\", \"rare\", \"dry\", \"set\", \"provides\", \"involved\", \"ends\", \"chum\", \"freelance\", \"hvac\", \"etc\")\ncorpus <- tm_map(corpus, removeWords, stopwords(\"english\"))\ncorpus <- tm_map(corpus, removeWords, custom_stopwords)\n\n#Create a term document matrix\ntdm <- TermDocumentMatrix(corpus)\n\n#Convert the term document matrix to a matrix\nm <- as.matrix(tdm)\n\n#Calculate word frequencies\nword_freq <- sort(rowSums(m), decreasing = TRUE)\n\n#Create the word cloud\nwordcloud(words = names(word_freq), freq = word_freq, scale = c(5, 1), random.order = FALSE, colors = brewer.pal(8, \"Dark2\"))\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex03_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}