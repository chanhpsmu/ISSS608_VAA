<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hin Phung">
<meta name="dcterms.date" content="2023-06-09">

<title>ISSS608_VAA - Take-Home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608_VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take_home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  </ul></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  <li><a href="#data-preparation-1" id="toc-data-preparation-1" class="nav-link" data-scroll-target="#data-preparation-1">Data Preparation</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a>
  <ul class="collapse">
  <li><a href="#exploring-edge-table" id="toc-exploring-edge-table" class="nav-link" data-scroll-target="#exploring-edge-table">Exploring edge table</a></li>
  <li><a href="#exploring-nodes-table" id="toc-exploring-nodes-table" class="nav-link" data-scroll-target="#exploring-nodes-table">Exploring nodes table</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  </ul></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a>
  <ul class="collapse">
  <li><a href="#countries-registered-by-top-revenue-companies" id="toc-countries-registered-by-top-revenue-companies" class="nav-link" data-scroll-target="#countries-registered-by-top-revenue-companies">Countries registered by top revenue companies</a></li>
  <li><a href="#individual-owners-with-multiple-companies" id="toc-individual-owners-with-multiple-companies" class="nav-link" data-scroll-target="#individual-owners-with-multiple-companies">Individual owners with multiple companies</a></li>
  <li><a href="#companies-that-have-registered-in-multiple-countries" id="toc-companies-that-have-registered-in-multiple-countries" class="nav-link" data-scroll-target="#companies-that-have-registered-in-multiple-countries">Companies that have registered in multiple countries</a></li>
  <li><a href="#word-cloud-on-product-services" id="toc-word-cloud-on-product-services" class="nav-link" data-scroll-target="#word-cloud-on-product-services">Word cloud on product services</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hin Phung </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 9, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 16, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye’s analysts had received import/export data for Oceanus’ marine and fishing industries, but the data is incomplete. FishEye had subsequently transformed the trade data into a knowledge graph to help them understand the business relationships, including finding links that will stop IUU fishing and protect marine species.</p>
<p>We will address Question 1 of VAST challenge 2023 MC3 - To Use visual analytics to identify anomalies in the business groups present in the knowledge graph</p>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology">Methodology</h3>
<p>To use different visualisation techniques to identify relationships and anomalies of entities in the businesss groups.</p>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data Preparation</h3>
<section id="installing-and-loading-of-r-packages" class="level4">
<h4 class="anchored" data-anchor-id="installing-and-loading-of-r-packages">Installing and loading of R packages</h4>
<p>The code chunk below will be used to install and load the necessary R packages as follows:</p>
<ul>
<li><p>jsonlite: a package supports both reading and writing JSON files, as well as working with JSON data retrieved from web APIs.</p></li>
<li><p>igraph: a package in R that offers a wide range of tools for creating, manipulating, and visualizing graphs, as well as various algorithms and metrics for network analysis.</p></li>
<li><p>tidygraph: provides a tidy and consistent approach to working with graph data using the principles of the tidyverse</p></li>
<li><p>ggraph: an extension package in R that builds upon the tidygraph and ggplot2 packages. It provides a high-level interface for creating visualizations of graph data using the grammar of graphics approach.</p></li>
<li><p>viznetwork: a package provides geoms for ggplot2 to repel overlapping text labels.</p></li>
<li><p>graphlayouts: a package that provides a collection of layout algorithms that can be used to visualize graphs.</p></li>
<li><p>ggforce: extension package for ggplot2 that provides additional functionalities and extensions to enhance and expand the capabilities of ggplot2 for data visualization.</p></li>
<li><p>tidyverse: a family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.</p></li>
<li><p>scales: package that provides various functions for scaling and formatting data, primarily for data visualization purposes.</p></li>
<li><p>wordcloud: package for creating word clouds, which are visual representations of textual data where the size of each word corresponds to its frequency or importance in the text.</p></li>
<li><p>tm: text mining package that provides tools for text preprocessing, document-term matrix creation, and various other text mining tasks.</p></li>
<li><p>treemap: a package that allows you to create treemaps, which are visualizations that display hierarchical data as nested rectangles.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               visNetwork, graphlayouts, ggforce, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               skimr, tidytext, tidyverse, scales, wordcloud, tm, treemap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="the-data" class="level1">
<h1>The Data</h1>
<p>The function fromJSON() of jsonlite package is used to import mc3.json into R environment. The data comprises:</p>
<ul>
<li><p>list of 27622 “nodes” with 5 columns (id, country, type, revenue_omu, project_services)</p></li>
<li><p>list of 24038 “links” with 3 columns (source, target, type)</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-preparation-1" class="level1">
<h1>Data Preparation</h1>
<p>The list of “links” are extracted to form an edge table. Correspondingly, the list of “nodes” are extracted to form a nodes table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract edges from the list</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract nodes from the list</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">product_services =</span> <span class="fu">as.character</span>(product_services),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">revenue_omu =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(revenue_omu)),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, country, type, revenue_omu, product_services)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-exploration" class="level1">
<h1>Data Exploration</h1>
<section id="exploring-edge-table" class="level3">
<h3 class="anchored" data-anchor-id="exploring-edge-table">Exploring edge table</h3>
<p>We first explore the created edge table. The report below reveals that there are not missing values in all fields.We also made comparison between Different types in the edge table. The bar graph below indicates that there are 2 types of entities in the edge table - company contacts and owners.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(mc3_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mc3_edges</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">24036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">source</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12856</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">target</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21265</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">weights</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_edges, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exploring-nodes-table" class="level3">
<h3 class="anchored" data-anchor-id="exploring-nodes-table">Exploring nodes table</h3>
<p>Similarly, we explore the created nodes table. The report above reveals that there are 21515 missing values under “revenue_omu” column and these rows will be subsequently removed when visualising the revenues of the companies. The bar graph comparing the types of entities in the nodes table reveal that there are 3 types of entities - company, company contacts and owners.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(mc3_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mc3_nodes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">27622</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">22929</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">country</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">product_services</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1737</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3244</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">revenue_omu</td>
<td style="text-align: right;">21515</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">1822155</td>
<td style="text-align: right;">18184433</td>
<td style="text-align: right;">3652.23</td>
<td style="text-align: right;">7676.36</td>
<td style="text-align: right;">16210.68</td>
<td style="text-align: right;">48327.66</td>
<td style="text-align: right;">310612303</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_nodes, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h3>
<p>We would need to extract the embedded lists of entities found under the “Source” column in the original edges table, and itemise into individual rows. This is done by splitting the string in the embedded lists into edges sub-table, and removing whitespaces and irrelevant characters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract lists from the edges table</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mc3_edge_unclean <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">substr</span>(source,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">%in%</span> <span class="st">"c("</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Break up the lists in the edge file by splitting the string</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mc3_edge_broken <span class="ot">&lt;-</span> <span class="fu">unnest</span>(mc3_edge_unclean, <span class="at">source =</span> <span class="fu">strsplit</span>(<span class="fu">as.character</span>(source), <span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">,|</span><span class="sc">\\</span><span class="st">)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespaces amd filter records with "c" value</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Create edges table incorporating the unlisted values</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mc3_edge_broken <span class="ot">&lt;-</span> mc3_edge_broken <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, source)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span><span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">trimws</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">target =</span> <span class="fu">trimws</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>From the original edges table, we will remove the lists, and subsequently concatenate the itemised values which were extracted from the embedded lists. This will form the clean edges table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create edges table without embedded lists from original edges table</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_without_list <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">substr</span>(source,<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">%in%</span> <span class="st">"c("</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Combine new edges table with edges table incorporated with the unlisted values, to form a combined edges table.  </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>mc3_edges_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mc3_edges_without_list, mc3_edge_broken)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we will join the edges table with nodes table into combined edge table by mapping edge “source” column in edge table with “id” column in nodes table. This will provide us with the information on the type of “source” entities in the edges table. The edges table will be used to derive the data for subsequent visualisation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_bysource <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mc3_edges_combined, mc3_nodes,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"source"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename relevant columns as "source type" and "target type"</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter combined edge table by removing unknown and NA values from relevant columns.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mc3_edges_bysource1 <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type.y, type.x, country, weights, revenue_omu, product_services) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">source_type =</span> type.y) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">target_type =</span> type.x) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_services <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_services <span class="sc">!=</span> <span class="st">"character(0)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="visualisation" class="level1">
<h1>Visualisation</h1>
<section id="countries-registered-by-top-revenue-companies" class="level3">
<h3 class="anchored" data-anchor-id="countries-registered-by-top-revenue-companies">Countries registered by top revenue companies</h3>
<p>The treemap is constructed based on the top 50 companies that generates the highest revenues. It is observed that, of the top 50 companies with the highest revenues, almost half of the total revenues are earned by companies registered in ZH country. The 2 highest earning companies are Jones LLC and Patton Ltd.&nbsp;The diagram also revealed that Assam Limited Liability Company and Aqua Advancements Sashimi SE Express are the highest earning company in Utoporiana country and Oceanus country respectively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Derive new edge table</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_toprevenue <span class="ot">&lt;-</span> mc3_edges_bysource1 <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (source, source_type, country, weights, revenue_omu, product_services) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(revenue_omu)) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter top 50 companies with highest revenues</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_toprevenue_filtered <span class="ot">&lt;-</span> mc3_edges_toprevenue <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (source_type <span class="sc">==</span> <span class="st">"Company"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> revenue_omu, <span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Construct treemap</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(mc3_edges_toprevenue_filtered,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">index=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"source"</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">vSize=</span><span class="st">"revenue_omu"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">vColor=</span><span class="st">"revenue_omu"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">"Revenue by Country and Company"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.legend =</span> <span class="st">"revenue of company"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="individual-owners-with-multiple-companies" class="level3">
<h3 class="anchored" data-anchor-id="individual-owners-with-multiple-companies">Individual owners with multiple companies</h3>
<p>One of the anormalies that we can detect is the number of companies the individual entities own. We can be suspicious of these individuals if they own an exceptionally high number of companies.</p>
<p>In this visualisation on individuals who own more than 5 companies, we observe that the individual who owns the largest number of companies is John Smith (owns a total of 11 companies). This is followed by Micheal Johnson and Jennifer Smith who owns 9 and 8 companies respectively. We can also infer that this group of owners are dominated by the presence of the Smith family.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter individual owners from edge table, and assign target to be source and vice versa</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (target, source, type.x, weights) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type.x <span class="sc">==</span> <span class="st">"Beneficial Owner"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="at">sc =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="at">tg =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter individuals who own more 5 companies</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners_filtered <span class="ot">&lt;-</span> mc3_edges_indivowners <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sc) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create corresponding nodes table out of the edges table</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>id1_inv <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sc) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> sc)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>id2_inv <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tg) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> tg)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>mc3_nodes_indivowners_filtered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_inv, id2_inv) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prep format for plotting</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners_filtered <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">from =</span> sc) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">to =</span> tg) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filter (target_type == "companies") %&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot interactive graph</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(mc3_nodes_indivowners_filtered, mc3_edges_indivowners_filtered) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"pink"</span>, <span class="at">border =</span> <span class="st">"red"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_gem"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5ae7d8d1be3438fd00e4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5ae7d8d1be3438fd00e4">{"x":{"nodes":{"id":["Richard Smith","John Smith","David Jones","Michael Bell","Michael Johnson","David Thomas","Michael Williams","Ashley Harris","Jennifer Smith","James Smith","Lisa Johnson","Jennifer Taylor","Anna Wheeler","John Williams","Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Aqua Aura SE Marine life","Arnold, Wise and Fuentes","Baker and Sons","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Byrd-Flores","Carter LLC","Chavez PLC","Chen, Jones and Davis","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Faroe Islands  Company World","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Guzman-Chang","Hall-Taylor","Hamilton LLC","Hancock Inc","Jacobs-Henry","Jones, Kennedy and Johnson","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar del Oeste -","Merritt-Austin","Miller, Wiggins and Smith","Montes, Kidd and Hall","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Ocean Quest S.A. de C.V.","Océano del Este Eel","Peterson PLC","Playa de la Luna Starfish","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ryan-Curry","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","Singleton Ltd","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","Thetis Ltd. Liability Co","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Velazquez-Harris","Walker-Lozano","Wright LLC","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","mán yú BV Coral Reef","Andhra Pradesh  Limited Liability Company Ray","Aqua Adventures Ltd. Corporation","Baltic Sprat Ges.m.b.H. Enterprises","Beachcombers Nautical Plc Carriers","Brisa del Mar GmbH","Dutch Mussels S.p.A. Sea spray","Karelians Plc Marine conservation","Kerala  Market Oyj Freight","Ltd. Corporation Ltd. Corporation","Maacama  S.p.A. Marine ecology","Mar de Cristal S.A. de C.V.","Marine Muse Pic Marine ecology","Melanippe GmbH & Co. KG","Náutica del Mar GmbH & Co. KG","Oka  S.A. de C.V.","Ola de la Costa AS","PacificPlates S.A. de C.V.","Punjab s Pic Express","Rufiji Delta  Limited Liability Company","Sea Striders Kelp BV Solutions","SeaSolutions Leska Kga Worldwide","SeaSplash Foods Corporation Freight","jīn qiāng yú AG"],"x":[-0.580886698537419,-0.0384733482792988,-0.68862080364646,0.519756813184589,0.0235888029201139,0.132144006259278,0.241399022138038,-0.325223237407633,-0.210391748894578,0.435570131022215,-0.737417185124209,0.717519399605896,-0.187807464383613,0.0696415870589453,-0.664381035640912,-0.263234580098498,-0.974128882814863,-0.922584028569499,0.768136783159535,-0.831105624085804,-0.0624379706867153,0.324037230665201,0.654142213792089,0.470914818403975,-0.387227647139969,0.318543662271454,-0.831730386788334,0.258909134423676,-0.935904421294714,-0.378861689753869,0.444954233443503,-0.48577623911069,0.595732148866546,-0.124419879938889,-0.889832475598276,0.39686928471396,-0.158766615934689,0.708908015717167,-0.43772138690334,0.260514234543017,0.708611847828385,0.227466379524577,0.164560091545411,-0.939400091305724,1,0.762964472439221,-0.9896269987858,-0.446850779024868,-0.926469668170389,-0.241324242707754,-0.87106527280063,-0.457225732939811,-0.446156755917269,-0.106520079575459,0.235779863175516,-0.281791990216139,0.675208400940013,0.173067268401322,0.0549246301998207,0.246042517760423,-0.200685049350722,0.988806128216394,-0.922557884359801,-1,0.275643455283739,0.0766812565394086,0.481209393471691,-0.966547654032285,0.0776812254209227,0.190552657155269,0.156052060251069,0.967257561706179,0.609947964170851,0.109890535363244,0.664562988637342,-0.202315075359741,0.234100095234519,0.0074507752338222,0.986304910365056,-0.729872140748635,0.0498810056574632,-0.760194047997938,-0.997156263729346,0.385303866063682,0.641684888994621,-0.52800597614026,0.0205668832741566,-0.791763793072644,0.696320807855263,0.218456970280987,-0.163698110032341,-0.24629342004655,-0.260605921293414,-0.438500857900119,-0.36813627380483,0.133840086505401,0.153211095998018,0.692380587250579,-0.30382234415609,-0.350607105350186,0.120961838055375,0.949284043493413,-0.224279391589346,-0.051163136243462,0.273678262985196,-0.299849865464195,0.728240468250062,-0.3840615545992,0.920730513039523,-0.0175668800847275,0.143864395880683,-0.351633678188364],"y":[-0.364426961020283,0.0351244664008585,-0.0569658684553256,0.527738199846958,0.12992853758938,-0.724824895502392,-0.299555601607786,0.73090273681955,0.208324933991906,-0.050218166593704,0.37080573614797,0.243922082243403,-0.356417670527871,0.534626095452876,-0.599722814087296,0.0237892491992064,-0.112186847621234,-0.0782712646959115,0.643982156873299,-0.422302041107243,0.294364811361247,-0.904711465482404,0.7487617924859,-0.379178272671093,0.935083879304305,-0.530804720598,-0.488653255078027,0.138761807744487,-0.161593469490593,0.402113931124253,-0.495870119289097,0.925424460553857,0.759911203696659,-0.167650457839152,-0.203055455946885,-0.450893807639966,-0.0578134301344189,-0.089204535940449,0.142066536776061,0.1981822842289,-0.145184128273799,0.276488187975996,0.2389648065648,0.542688195258648,0.25916240582652,0.589205621883509,0.343681485572384,0.270327754305059,0.485207806125145,0.431332732253886,0.567306305607933,0.212895128275731,0.345049105353986,-0.570677743990681,0.0645162517793132,0.971411468348501,-0.211615797454752,-0.954428102609091,-0.966818700989125,-0.526280864134855,-0.13302042031163,0.349878910259244,0.0219797764550886,0.409183023779887,-0.951645480016295,-0.126333987026958,-0.44353497102382,-0.0307193421121992,0.323195862840074,0.768165735326431,0.319595593599813,0.14183599800122,-0.227124800380489,0.803956240122825,0.0242473919403738,0.0961549654660732,0.724237262582222,0.338243530482794,0.200658208970619,-0.580803081779258,0.777795420537713,-0.503797861057218,0.467553247959636,-0.530237265142144,-0.140386131455021,0.875251058821825,-0.179195451161678,-0.560912260594338,-0.040061097209921,-0.975950476560345,-0.60448438047104,-0.55346747234249,-0.0572346069884734,0.970639307139558,0.330886103104289,0.730561412104735,-0.0130154684315311,0.671069166482246,0.419866827775785,1,-1,0.295780300191191,-0.627271731964819,-0.161675545869461,0.680093861052482,-0.598304349280164,0.719336562879545,-0.485335567209908,0.389226637819547,0.754546676028246,-0.092296191408864,-0.556400160196137],"label":["Richard Smith","John Smith","David Jones","Michael Bell","Michael Johnson","David Thomas","Michael Williams","Ashley Harris","Jennifer Smith","James Smith","Lisa Johnson","Jennifer Taylor","Anna Wheeler","John Williams","Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Aqua Aura SE Marine life","Arnold, Wise and Fuentes","Baker and Sons","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Byrd-Flores","Carter LLC","Chavez PLC","Chen, Jones and Davis","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Faroe Islands  Company World","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Guzman-Chang","Hall-Taylor","Hamilton LLC","Hancock Inc","Jacobs-Henry","Jones, Kennedy and Johnson","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar del Oeste -","Merritt-Austin","Miller, Wiggins and Smith","Montes, Kidd and Hall","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Ocean Quest S.A. de C.V.","Océano del Este Eel","Peterson PLC","Playa de la Luna Starfish","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ryan-Curry","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","Singleton Ltd","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","Thetis Ltd. Liability Co","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Velazquez-Harris","Walker-Lozano","Wright LLC","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","mán yú BV Coral Reef","Andhra Pradesh  Limited Liability Company Ray","Aqua Adventures Ltd. Corporation","Baltic Sprat Ges.m.b.H. Enterprises","Beachcombers Nautical Plc Carriers","Brisa del Mar GmbH","Dutch Mussels S.p.A. Sea spray","Karelians Plc Marine conservation","Kerala  Market Oyj Freight","Ltd. Corporation Ltd. Corporation","Maacama  S.p.A. Marine ecology","Mar de Cristal S.A. de C.V.","Marine Muse Pic Marine ecology","Melanippe GmbH & Co. KG","Náutica del Mar GmbH & Co. KG","Oka  S.A. de C.V.","Ola de la Costa AS","PacificPlates S.A. de C.V.","Punjab s Pic Express","Rufiji Delta  Limited Liability Company","Sea Striders Kelp BV Solutions","SeaSolutions Leska Kga Worldwide","SeaSplash Foods Corporation Freight","jīn qiāng yú AG"]},"edges":{"from":["Richard Smith","John Smith","David Jones","David Jones","Michael Bell","Richard Smith","Michael Johnson","David Thomas","Michael Bell","Michael Williams","Ashley Harris","Michael Williams","Richard Smith","Michael Johnson","David Jones","Jennifer Smith","Michael Williams","Ashley Harris","Michael Bell","John Smith","David Jones","Michael Williams","John Smith","James Smith","Jennifer Smith","Michael Johnson","James Smith","Michael Johnson","Michael Johnson","Lisa Johnson","Jennifer Taylor","Michael Bell","Lisa Johnson","Jennifer Smith","Lisa Johnson","Jennifer Smith","Lisa Johnson","Jennifer Smith","Jennifer Smith","Anna Wheeler","Michael Johnson","Ashley Harris","James Smith","David Thomas","David Thomas","Michael Williams","John Smith","Jennifer Taylor","David Jones","Lisa Johnson","David Thomas","John Smith","Michael Williams","David Jones","Michael Johnson","John Williams","Michael Johnson","Jennifer Taylor","James Smith","John Williams","James Smith","John Smith","John Williams","Michael Johnson","Jennifer Taylor","Richard Smith","John Williams","Richard Smith","Lisa Johnson","Michael Williams","James Smith","Ashley Harris","John Smith","Richard Smith","James Smith","David Thomas","Anna Wheeler","Anna Wheeler","John Smith","Ashley Harris","Jennifer Smith","John Williams","John Smith","Michael Bell","Jennifer Smith","Ashley Harris","David Thomas","Jennifer Taylor","Anna Wheeler","John Smith","John Williams","Anna Wheeler","Michael Bell","Anna Wheeler","Jennifer Taylor","John Williams","John Smith","Anna Wheeler"],"to":["Acevedo, Dickson and Gonzalez","Adams Group","Adriatic Catch S.A. de C.V.","Alexander PLC","Aqua Aura SE Marine life","Arnold, Wise and Fuentes","Baker and Sons","BlueTide GmbH & Co. KG","Brewer Inc","Brown-Evans","Byrd-Flores","Carter LLC","Chavez PLC","Chen, Jones and Davis","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis, Webb and Martin","Dean-Fisher","Faroe Islands  Company World","Garcia, Ferguson and Miller","Garcia, Smith and Scott","Guzman-Chang","Hall-Taylor","Hamilton LLC","Hancock Inc","Jacobs-Henry","Jones, Kennedy and Johnson","Knight-Brown","Kong zhong diao yu  GmbH","Lang, Garcia and Harris","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal ОАО","Mar del Oeste -","Merritt-Austin","Miller, Wiggins and Smith","Montes, Kidd and Hall","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Ocean Quest S.A. de C.V.","Océano del Este Eel","Peterson PLC","Playa de la Luna Starfish","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Ryan-Curry","Sanchez PLC","Sander Ltd. Liability Co Solutions","SeaBass  Leska N.V. International","SeaSolutions Dry dock OJSC Transit","Seashell Seekers ОАО International","Singleton Ltd","Spanish Shrimp A/S Marine","Sullivan, Simon and Farmer","Taylor, Choi and Merritt","The Salted Pearl Inc Pelican","Thetis Ltd. Liability Co","Thompson LLC","Thompson, Shepherd and Phillips","TideTurner Tidepool Co Enterprises","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Velazquez-Harris","Walker-Lozano","Wright LLC","hǎi zhé Herring Incorporated Logistics","hǎi zhé S.A. de C.V.","mán yú BV Coral Reef","Andhra Pradesh  Limited Liability Company Ray","Aqua Adventures Ltd. Corporation","Baltic Sprat Ges.m.b.H. Enterprises","Beachcombers Nautical Plc Carriers","Brisa del Mar GmbH","Dutch Mussels S.p.A. Sea spray","Karelians Plc Marine conservation","Kerala  Market Oyj Freight","Ltd. Corporation Ltd. Corporation","Maacama  S.p.A. Marine ecology","Mar de Cristal S.A. de C.V.","Marine Muse Pic Marine ecology","Melanippe GmbH & Co. KG","Náutica del Mar GmbH & Co. KG","Oka  S.A. de C.V.","Ola de la Costa AS","PacificPlates S.A. de C.V.","Punjab s Pic Express","Rufiji Delta  Limited Liability Company","Sea Striders Kelp BV Solutions","SeaSolutions Leska Kga Worldwide","SeaSplash Foods Corporation Freight","jīn qiāng yú AG"],"type.x":["Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner"],"weights":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,3,2,1,1,2,1,1,2,1,1,3,1,2,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"background":"pink","border":"red"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="companies-that-have-registered-in-multiple-countries" class="level3">
<h3 class="anchored" data-anchor-id="companies-that-have-registered-in-multiple-countries">Companies that have registered in multiple countries</h3>
<p>While it is true that companies are typically registered in the country where they are headquartered or where they conduct their primary operations, it is not unheard of for companies to be registered in multiple countries. Nevertheless for our visualisation, we wish to identify such companies as such situations may not be entirely normal and these companies may potentially breach some form of legality.</p>
<p>The bar chart below shows the companies that have registered in more than one country. It reveals that Aqua Aura SE marine Life has the highest number of countries it registers in (9 countries in total). This is followed by Transit Limited Liability Company as well as Tamil Nadu S A/S, with both registered in 4 countries each.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Derive specific edge table and filter all companies</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (source, country, type.y) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type.y <span class="sc">==</span> <span class="st">"Company"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter companies that are registered in more than 1 country</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered_one <span class="ot">&lt;-</span> mc3_edges_country <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_edges_country_filtered_one, <span class="fu">aes</span>(<span class="at">x =</span> source)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Companies"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"No of countries registered"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To gather deeper insights, we will drill down to more extreme cases to uncover deeper insights on such companies. The visualisation below focuses on companies which are registered in more than 2 countries. From the network plot, we can pick up the names of the countries that companies register in. In the case of Aqua Aura SE Marine Life, this company has registered in the 9 countries - Oceanus, Coralmarica, Alverossia, Nalakond, Rio Isla, Talandria, Icarnia, Mawazam and Isliandor.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter companies that are registered in more than 2 countries</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered <span class="ot">&lt;-</span> mc3_edges_country <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create corresponding nodes table out of the edges table</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>id1_con <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>id2_con <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> country)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>mc3_nodes_country_filtered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_con, id2_con) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prep format for plotting</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">from =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">to =</span> country) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot interactive graph</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(mc3_nodes_country_filtered, mc3_edges_country_filtered) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"orange"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_gem"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-06bd91404f238a7fbc39" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-06bd91404f238a7fbc39">{"x":{"nodes":{"id":["Aqua Aura SE Marine life","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu bi sai  BV","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar del Paraíso GmbH","Océano del Este Co","Perla del Mar Co","Solutions Limited Liability Company","Tamil Nadu s A/S","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Korvelonia","Marebak","Zawalinda","Gavanovia","Kondarivakia","Faraluna","Kondanovia","Puerto del Mar","Puerto Sol","Kethilim","Sol y Oceana","Osterivaro","Thessalandia","Brindisola"],"x":[0.104775660341486,0.773288577360129,-0.283041763849973,-0.064921997181449,0.639351066681141,0.339358172684607,0.491730869969784,0.0642538414118072,0.702320295706818,0.386577832074171,-0.699157237364678,0.0135575176926424,0.442896464130241,-0.046679115028665,-0.66154020752923,0.486353564420304,0.191462519581098,-0.104192712463948,0.236194052869977,-0.286630816719681,0.0769032275697685,-0.227207030163829,0.259984532562547,-0.137845395381517,0.981331830927851,0.57112869638537,0.00241622558660448,0.306699824004956,-0.174720965011237,0.940191434704424,0.0682235992030873,-0.0900584706712012,1,0.934039614476861,-0.932801654049474,-1,0.635019543767746,0.497182046829467,-0.949184405256425,-0.878998760998851],"y":[-0.0496243842377124,-0.788182903605426,-0.570807133507699,-0.372385834454284,-0.0306461538781878,-0.675401857266867,0.217654897486294,0.666755316283013,0.33862843345581,-0.287589255267449,-0.227816217001847,0.229196022574204,0.481382832935697,-0.170739984256687,0.216508183557697,-0.446018884590518,-0.324519745173099,0.203015989715949,0.122450096590374,-0.0462555683781655,-0.500708946514162,-0.226047406908521,0.385204447932979,0.0492963909882651,-0.997424010389925,-1,-0.876897567457325,-0.072888488913694,-0.689179083338965,-0.0928374722802862,1,0.95081136943208,0.408381062954486,0.569167483630621,-0.426501717323339,-0.243626946294029,0.754063483980827,0.817563843628922,0.273161285099359,0.443960253960967],"label":["Aqua Aura SE Marine life","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu bi sai  BV","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar del Paraíso GmbH","Océano del Este Co","Perla del Mar Co","Solutions Limited Liability Company","Tamil Nadu s A/S","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Korvelonia","Marebak","Zawalinda","Gavanovia","Kondarivakia","Faraluna","Kondanovia","Puerto del Mar","Puerto Sol","Kethilim","Sol y Oceana","Osterivaro","Thessalandia","Brindisola"]},"edges":{"from":["Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Bahía del Sol Corporation","Bahía del Sol Corporation","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Bay of Bengal's Ltd. Liability Co","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu  BV Logistics","Diao yu  BV Logistics","Diao yu bi sai  BV","Diao yu bi sai  BV","Diao yu bi sai  BV","Jammu S.A. de C.V.","Jammu S.A. de C.V.","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Manipur  Market Ltd. Liability Co","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar de Coral ОАО","Mar de Coral ОАО","Mar del Paraíso GmbH","Mar del Paraíso GmbH","Mar del Paraíso GmbH","Océano del Este Co","Océano del Este Co","Océano del Este Co","Perla del Mar Co","Perla del Mar Co","Perla del Mar Co","Solutions Limited Liability Company","Solutions Limited Liability Company","Solutions Limited Liability Company","Tamil Nadu s A/S","Tamil Nadu s A/S","Tamil Nadu s A/S","Tamil Nadu s A/S","Transit Limited Liability Company","Transit Limited Liability Company","Transit Limited Liability Company","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Yenisei  Eel GmbH & Co. KG Services","Yenisei  Eel GmbH & Co. KG Services"],"to":["Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Mawazam","Coralmarica","Korvelonia","Nalakond","Nalakond","Marebak","Zawalinda","Oceanus","Marebak","Gavanovia","Utoporiana","Korvelonia","Marebak","Oceanus","Marebak","Isliandor","Kondarivakia","Oceanus","Faraluna","Oceanus","Kondanovia","Puerto del Mar","Oceanus","Marebak","Coralmarica","Puerto Sol","Nalakond","Kethilim","Nalakond","Marebak","Oceanus","Marebak","Isliandor","Sol y Oceana","Osterivaro","Nalakond","Oceanus","Alverossia","Coralmarica","Thessalandia","Brindisola","Nalakond"],"type.y":["Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"background":"lightgreen","border":"orange"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"from","smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="word-cloud-on-product-services" class="level3">
<h3 class="anchored" data-anchor-id="word-cloud-on-product-services">Word cloud on product services</h3>
<p>The word cloud provides an overview of the range of product services provided by the companies. It also provides us with an indication of the more common business groups and the product mix. We can infer that most of the companies are dealing in food related services, in particular seafood and fish. In terms of the fish types, the salmon would seem to be the most common.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>column_values <span class="ot">&lt;-</span> mc3_edges_toprevenue<span class="sc">$</span>product_services</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a Corpus</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(column_values))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Preprocess the words</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removePunctuation)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeNumbers)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Add custom stopwords</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>custom_stopwords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"products"</span>, <span class="st">"systems"</span>, <span class="st">"including"</span>, <span class="st">"solutions"</span>, <span class="st">"industrial"</span>, <span class="st">"wide"</span>, <span class="st">"short"</span>, <span class="st">"fat"</span>, <span class="st">"die"</span>, <span class="st">"related"</span>, <span class="st">"equipment"</span>, <span class="st">"range"</span>, <span class="st">"offers"</span>, <span class="st">"kits"</span>, <span class="st">"frozen"</span>, <span class="st">"wild"</span>, <span class="st">"kit"</span>, <span class="st">"soft"</span>, <span class="st">"hard"</span>, <span class="st">"non"</span>, <span class="st">"cooked"</span>, <span class="st">"ltl"</span>, <span class="st">"dust"</span>, <span class="st">"full"</span>, <span class="st">"processing"</span>, <span class="st">"high"</span>, <span class="st">"dried"</span>, <span class="st">"far"</span>, <span class="st">"low"</span>, <span class="st">"roll"</span>, <span class="st">"flat"</span>, <span class="st">"raw"</span>, <span class="st">"source"</span>, <span class="st">"lcl"</span>, <span class="st">"men"</span>, <span class="st">"strip"</span>, <span class="st">"include"</span>, <span class="st">"multi"</span>, <span class="st">"natural"</span>, <span class="st">"general"</span>, <span class="st">"unit"</span>, <span class="st">"care"</span>, <span class="st">"hot"</span>, <span class="st">"rare"</span>, <span class="st">"dry"</span>, <span class="st">"set"</span>, <span class="st">"provides"</span>, <span class="st">"involved"</span>, <span class="st">"ends"</span>, <span class="st">"chum"</span>, <span class="st">"freelance"</span>, <span class="st">"hvac"</span>, <span class="st">"etc"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, custom_stopwords)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a term document matrix</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>tdm <span class="ot">&lt;-</span> <span class="fu">TermDocumentMatrix</span>(corpus)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert the term document matrix to a matrix</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tdm)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate word frequencies</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>word_freq <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rowSums</span>(m), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the word cloud</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(<span class="at">words =</span> <span class="fu">names</span>(word_freq), <span class="at">freq =</span> word_freq, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>