<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Hin Phung">
<meta name="dcterms.date" content="2023-06-09">

<title>ISSS608_VAA - Take-Home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608_VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take_home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  </ul></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  <li><a href="#data-preparation-1" id="toc-data-preparation-1" class="nav-link" data-scroll-target="#data-preparation-1">Data Preparation</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a>
  <ul class="collapse">
  <li><a href="#exploring-edge-table" id="toc-exploring-edge-table" class="nav-link" data-scroll-target="#exploring-edge-table">Exploring edge table</a></li>
  <li><a href="#exploring-nodes-table" id="toc-exploring-nodes-table" class="nav-link" data-scroll-target="#exploring-nodes-table">Exploring nodes table</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  </ul></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a>
  <ul class="collapse">
  <li><a href="#countries-registered-by-top-revenue-companies" id="toc-countries-registered-by-top-revenue-companies" class="nav-link" data-scroll-target="#countries-registered-by-top-revenue-companies">Countries registered by top revenue companies</a></li>
  <li><a href="#individual-owners-with-multiple-companies" id="toc-individual-owners-with-multiple-companies" class="nav-link" data-scroll-target="#individual-owners-with-multiple-companies">Individual owners with multiple companies</a></li>
  <li><a href="#companies-that-have-registered-in-multiple-countries" id="toc-companies-that-have-registered-in-multiple-countries" class="nav-link" data-scroll-target="#companies-that-have-registered-in-multiple-countries">Companies that have registered in multiple countries</a></li>
  <li><a href="#word-cloud-on-product-services" id="toc-word-cloud-on-product-services" class="nav-link" data-scroll-target="#word-cloud-on-product-services">Word cloud on product services</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Hin Phung </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 9, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 16, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye’s analysts had received import/export data for Oceanus’ marine and fishing industries, but the data is incomplete. FishEye had subsequently transformed the trade data into a knowledge graph to help them understand the business relationships, including finding links that will stop IUU fishing and protect marine species.</p>
<p>We will address Question 1 of VAST challenge 2023 MC3 - To Use visual analytics to identify anomalies in the business groups present in the knowledge graph</p>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology">Methodology</h3>
<p>To use different visualisation techniques to identify relationships and anomalies of entities in the businesss groups.</p>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data Preparation</h3>
<section id="installing-and-loading-of-r-packages" class="level4">
<h4 class="anchored" data-anchor-id="installing-and-loading-of-r-packages">Installing and loading of R packages</h4>
<p>The code chunk below will be used to install and load the necessary R packages as follows:</p>
<ul>
<li><p>jsonlite: a package supports both reading and writing JSON files, as well as working with JSON data retrieved from web APIs.</p></li>
<li><p>igraph: a package in R that offers a wide range of tools for creating, manipulating, and visualizing graphs, as well as various algorithms and metrics for network analysis.</p></li>
<li><p>tidygraph: provides a tidy and consistent approach to working with graph data using the principles of the tidyverse</p></li>
<li><p>ggraph: an extension package in R that builds upon the tidygraph and ggplot2 packages. It provides a high-level interface for creating visualizations of graph data using the grammar of graphics approach.</p></li>
<li><p>viznetwork: a package provides geoms for ggplot2 to repel overlapping text labels.</p></li>
<li><p>graphlayouts: a package that provides a collection of layout algorithms that can be used to visualize graphs.</p></li>
<li><p>ggforce: extension package for ggplot2 that provides additional functionalities and extensions to enhance and expand the capabilities of ggplot2 for data visualization.</p></li>
<li><p>tidyverse: a family of modern R packages specially designed to support data science, analysis and communication task including creating static statistical graphs.</p></li>
<li><p>scales: package that provides various functions for scaling and formatting data, primarily for data visualization purposes.</p></li>
<li><p>wordcloud: package for creating word clouds, which are visual representations of textual data where the size of each word corresponds to its frequency or importance in the text.</p></li>
<li><p>tm: text mining package that provides tools for text preprocessing, document-term matrix creation, and various other text mining tasks.</p></li>
<li><p>treemap: a package that allows you to create treemaps, which are visualizations that display hierarchical data as nested rectangles.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               visNetwork, graphlayouts, ggforce, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               skimr, tidytext, tidyverse, scales, wordcloud, tm, treemap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="the-data" class="level1">
<h1>The Data</h1>
<p>The function fromJSON() of jsonlite package is used to import mc3.json into R environment. The data comprises:</p>
<ul>
<li><p>list of 27622 “nodes” with 5 columns (id, country, type, revenue_omu, project_services)</p></li>
<li><p>list of 24038 “links” with 3 columns (source, target, type)</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc3_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-preparation-1" class="level1">
<h1>Data Preparation</h1>
<p>The list of “links” are extracted to form an edge table. Correspondingly, the list of “nodes” are extracted to form a nodes table.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract edges from the list</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">as.character</span>(source),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">target =</span> <span class="fu">as.character</span>(target),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract nodes from the list</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc3_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">as.character</span>(country),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">id =</span> <span class="fu">as.character</span>(id),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">product_services =</span> <span class="fu">as.character</span>(product_services),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">revenue_omu =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(revenue_omu)),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as.character</span>(type)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, country, type, revenue_omu, product_services)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-exploration" class="level1">
<h1>Data Exploration</h1>
<section id="exploring-edge-table" class="level3">
<h3 class="anchored" data-anchor-id="exploring-edge-table">Exploring edge table</h3>
<p>We first explore the created edge table. The report below reveals that there are not missing values in all fields.We also made comparison between Different types in the edge table. The bar graph below indicates that there are 2 types of entities in the edge table - company contacts and owners.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(mc3_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mc3_edges</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">24036</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">source</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12856</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">target</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21265</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">weights</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_edges, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exploring-nodes-table" class="level3">
<h3 class="anchored" data-anchor-id="exploring-nodes-table">Exploring nodes table</h3>
<p>Similarly, we explore the created nodes table. The report above reveals that there are 21515 missing values under “revenue_omu” column and these rows will be subsequently removed when visualising the revenues of the companies. The bar graph comparing the types of entities in the nodes table reveal that there are 3 types of entities - company, company contacts and owners.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(mc3_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">mc3_nodes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">27622</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">22929</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">country</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">product_services</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1737</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3244</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">revenue_omu</td>
<td style="text-align: right;">21515</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">1822155</td>
<td style="text-align: right;">18184433</td>
<td style="text-align: right;">3652.23</td>
<td style="text-align: right;">7676.36</td>
<td style="text-align: right;">16210.68</td>
<td style="text-align: right;">48327.66</td>
<td style="text-align: right;">310612303</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_nodes, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h3>
<p>We would need to extract the lists of entities found under the “Source” column in the edges table, and itemise them in separate rows. This is done by splitting the string in the lists into a new edges table, after removing whitespaces and irrelevant characters.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Break up the lists in the edge file by splitting the string</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mc3_edge_broken <span class="ot">&lt;-</span> <span class="fu">unnest</span>(mc3_edges, <span class="at">source =</span> <span class="fu">strsplit</span>(<span class="fu">as.character</span>(source), <span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">,|</span><span class="sc">\\</span><span class="st">)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove whitespaces amd filter records with "c" value </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mc3_edge_broken <span class="ot">&lt;-</span> mc3_edge_broken <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, source)) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span><span class="st">"c"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">trimws</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">target =</span> <span class="fu">trimws</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">!=</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we will join the edges table with nodes table into combined edge table by mapping edge “source” column in edge table with “id” column in nodes table. This will provide us with the information on the type of “source” entities in the edges table. The edges table will be used to derive the data for subsequent visualisation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_bysource <span class="ot">&lt;-</span> <span class="fu">left_join</span>(mc3_edge_broken, mc3_nodes,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"source"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename relevant columns as "source type" and "target type"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter combined edge table by removing unknown and NA values from relevant columns.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>mc3_edges_bysource1 <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, type.y, type.x, country, weights, revenue_omu, product_services) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">source_type =</span> type.y) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">target_type =</span> type.x) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(revenue_omu != "NA") %&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_services <span class="sc">!=</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(product_services <span class="sc">!=</span> <span class="st">"character(0)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="visualisation" class="level1">
<h1>Visualisation</h1>
<section id="countries-registered-by-top-revenue-companies" class="level3">
<h3 class="anchored" data-anchor-id="countries-registered-by-top-revenue-companies">Countries registered by top revenue companies</h3>
<p>The treemap is constructed based on the top 50 companies that generates the highest revenues. It is observed that, of the top 50 companies with the highest revenues, almost half of the total revenues are earned by companies registered in ZH country. The 2 highest earning companies are Jones LLC and Patton Ltd.&nbsp;The diagram also revealed that Assam Limited Liability Company and Aqua Advancements Sashimi SE Express are the highest earning company in Utoporiana country and Oceanus country respectively.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Derive new edge table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_toprevenue <span class="ot">&lt;-</span> mc3_edges_bysource1 <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (source, source_type, country, weights, revenue_omu, product_services) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(revenue_omu)) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter top 50 companies with highest revenues</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_toprevenue_filtered <span class="ot">&lt;-</span> mc3_edges_toprevenue <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (source_type <span class="sc">==</span> <span class="st">"Company"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> revenue_omu, <span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Construct treemap</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(mc3_edges_toprevenue_filtered,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">index=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"source"</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">vSize=</span><span class="st">"revenue_omu"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">vColor=</span><span class="st">"revenue_omu"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">"Revenue by Country and Company"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.legend =</span> <span class="st">"revenue of company"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="individual-owners-with-multiple-companies" class="level3">
<h3 class="anchored" data-anchor-id="individual-owners-with-multiple-companies">Individual owners with multiple companies</h3>
<p>One of the anormalies that we can detect is the number of companies the individual entities own. We can be suspicious of these individuals if they own an exceptionally high number of companies.</p>
<p>In this visualisation, we can observe that there are seven individuals (Richard Smith, Jennifer Smith, James Smith, Jennifer Taylor, Micheal Williams, John Williams, Ashley Harris) who own the largest number of companies (total of 8 companies each). We can also infer that there are two big families among the above list - the Smith family and Williams family. In addition, we can detect that Michael Williams and David Jones co-own Garcia, as well as Ashley Harris and Amy Martinez co-own Davis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter individual owners from edge table, and assign target to be source and vice versa</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (target, source, type.x, weights) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type.x <span class="sc">==</span> <span class="st">"Beneficial Owner"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="at">sc =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="at">tg =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter individuals who own more 5 companies</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners_filtered <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc3_edges_indivowners, <span class="fu">ave</span>(sc, sc, <span class="at">FUN =</span> length) <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create corresponding nodes table out of the edges table</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>id1_inv <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sc) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> sc)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>id2_inv <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tg) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> tg)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mc3_nodes_indivowners_filtered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_inv, id2_inv) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prep format for plotting</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_indivowners_filtered <span class="ot">&lt;-</span> mc3_edges_indivowners_filtered <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">from =</span> sc) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">to =</span> tg) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filter (target_type == "companies") %&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot interactive graph</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(mc3_nodes_indivowners_filtered, mc3_edges_indivowners_filtered) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"pink"</span>, <span class="at">border =</span> <span class="st">"red"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_gem"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a54970a49e8cae1c5951" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a54970a49e8cae1c5951">{"x":{"nodes":{"id":["Richard Smith","David Jones","Michael Miller","David Thomas","Mark Miller","Anna Wheeler","Michael Bell","Joshua Smith","Joshua Martin","John Gonzalez","Ashley Harris","Michael Williams","Amy Williams","James Smith","Jennifer Smith","Amy Martinez","Jennifer Taylor","Michael Jackson","Christopher Jones","John Williams","Lisa Johnson","Acevedo","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez","Andhra Pradesh  Limited Liability Company Ray","Andrews","Aqua Adventures Ltd. Corporation","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold","Ashley","Assam   Ltd. Liability Co","Baker","Baltic Sprat Ges.m.b.H. Enterprises","Barnett","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","Brewer Inc","Brisa del Mar GmbH","Brown and Alvarez","Brown-Evans","Byrd-Flores","Carter LLC","Chase","Chavez PLC","Choi and Merritt","Christensen and Bender","Collins and Johnson","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis","Dean-Fisher","Deep Sea Divers BV Logistics","Dickson and Gonzalez","Dnipro  Saltwater N.V. Services","Dutch Mussels S.p.A. Sea spray","Ferguson and Miller","Finley and Mcdaniel","Fowler-Davis","Garcia","Garcia and Acevedo","Garcia and Harris","Graham Inc","Group S.A. de C.V.","Hall-Taylor","Hamilton LLC","Hernandez","Hernandez and Wade","Herring","Horton and Lewis","Jacobs-Henry","Johnson","Johnson and Wright","Karelians Plc Marine conservation","Kariba Dam   CJSC Marine sanctuary","Khundu N.V. and Son's","Kidd and Hall","Kline and Roberts","Kong zhong diao yu  GmbH","Lang","Lara","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Ltd. Corporation Ltd. Corporation","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Maacama  S.p.A. Marine ecology","Malawi Rift   S.A. de C.V. Express","Malone and Willis","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal S.A. de C.V.","Mar de Cristal ОАО","Mar del Oeste -","Mar del Placer Plc","Marine Muse Pic Marine ecology","Martinez","Matthews and White","Meadows","Melanippe GmbH & Co. KG","Merritt-Austin","Montes","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Norwegian Fjord  S.A. de C.V. Brothers","Náutica del Mar GmbH & Co. KG","Ocean Quest S.A. de C.V.","Océano del Este Eel","Ola de la Costa AS","PacificPlates S.A. de C.V.","Phillips and Moody","Playa de Arena Ltd. Liability Co","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Punjab  Market Ltd. Liability Co Brothers","Punjab s Pic Express","Reese","Reyes-Kelly","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Rufiji Delta  Limited Liability Company","Sanchez PLC","Sander Ltd. Liability Co Solutions","Sea Striders Kelp BV Solutions","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","SeaSolutions Leska Kga Worldwide","Seashell Sanctum Co Family","Selkie GmbH Marine life","Shepherd and Phillips","SilverScales Ltd. Liability Co","Simon and Farmer","Singleton Ltd","Smith and Harrison","Smith and Scott","Spanish Shrimp A/S Marine","Sullivan","Taylor","Thetis Ltd. Liability Co","Thompson","TideTurner Tidepool Co Enterprises","Tucker-Turner","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttar Pradesh Sea  United","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Webb and Martin","Werner-Ortiz","West Bengal  Co _","West Fish  GmbH Transport","Wise and Fuentes","Wright LLC","Young and Ramos","hǎi mǎ S.p.A. Transport","hǎi zhé S.A. de C.V.","jīn qiāng yú AG","mán yú BV Coral Reef"],"x":[-0.102927856610059,0.314657009966878,-0.583953735279258,-0.71991354401823,-0.527597253258966,0.313016099354714,0.772207648648288,0.362613541420746,-0.242034567228947,0.519272988497754,-0.0387091309774444,0.0762064020791888,0.216591189991976,-0.16405763910945,-0.374299104073834,0.0829809788116369,-0.163588087156389,0.139449034638418,-0.289788509934252,-0.00241922816203666,-0.776703226675522,-0.0375148456252136,0.527279761771287,0.426357826921269,-0.716697959688611,-0.888644109575379,-0.639764225730028,0.530037692865443,0.97238435493659,-0.686379380922172,-0.265673634723418,0.544154164243245,-0.352916071251136,0.703236986788769,0.489469935237504,-0.289409033652054,0.595729380891696,-0.862905371987079,0.978086963857817,0.0785523930435599,-0.199181403533209,0.184283885486325,0.0480196209707342,0.210915862118551,0.330626864809591,-0.171634166692862,-0.34957969325579,0.551515585273438,0.704613370166837,0.52006206893538,-0.555103002853397,0.226961305348101,0.0168873473844238,0.964351829905181,0.381825080443956,-0.274666733619955,-0.595860141926049,-0.543564205147296,0.505534960874502,-0.667841747455324,-0.763613168145797,0.293275827512713,0.640652725252244,-0.312232725532793,0.540524281881293,0.18471291259975,-0.314164592566739,-0.589465976838441,-0.29949152649684,0.389252878566471,0.726416857361382,0.0481302454403019,-0.323709076998997,-0.248314436424506,-0.385752006743942,0.17146778436555,-0.416181376905616,0.133760183741242,-0.13907685134893,0.0956683319625264,-0.968236702440135,-0.27212734065161,0.144918618041188,0.926444475554498,-0.99224636548095,0.988200365654034,-0.555608231981403,-0.945756217713131,-0.516219994217285,-0.726273371705124,0.344995743691506,-0.595066370993367,-0.979725985402682,-0.00279795023475271,-0.564530219135005,-0.53465979557742,0.278938830902637,-0.938692058556382,0.181622665035746,0.090540858733015,0.225267226417486,-0.229319132919187,0.449349437562208,-0.118016043330623,-0.226428863457934,-0.917338926657036,-0.726692554636796,0.525256522378056,-0.922649840300845,0.0411601270522775,0.0538307274725209,0.485001051381712,0.537416828450899,0.663458144734518,-0.180156891883881,0.297257997816932,-0.78557528504947,1,0.579734441409455,-0.763788304477238,0.458501315977539,-1,-0.942155733072251,0.521119130589893,0.0870147852570207,0.478173867296911,-0.14930625229,-0.397887457683418,0.0897348582707338,0.152474808808265,0.201985705361377,-0.307054288636047,-0.323185832695606,0.590463829693185,0.139134454915971,-0.243748487907073,-0.249458237189319,0.144391880637283,-0.370921743350462,-0.0181069890612765,-0.279886579338332,0.154761551837812,-0.108050297320289,-0.195561660615234,0.593794420423256,0.101949387000263,-0.222846393707842,-0.96614514367788,0.246376623822195,0.126610070178976,-0.332645863488839,-0.175085443947919,-0.0308344383380814,-0.354498961260681,0.199767550760974,-0.647879854049979,-0.249084430762146,-0.0665386580909909,-0.70269989164969,0.265237709373246,-0.102719837756445,0.433543387989654,-0.258122967669419],"y":[0.0451173848434763,0.191385545712639,0.518587902790371,-0.241845834159901,-0.503246102626454,-0.202015822104632,-0.201736751527594,0.0222025876745278,0.766589186716149,0.587454162335578,-0.279419384227646,0.230629134606158,-0.363947167773452,-0.121954644177014,0.037261569094537,-0.773882235105085,0.309721622127657,0.725702175861239,-0.702836024777401,-0.0184654238215445,0.190643170877478,0.177135089704673,0.270253389200103,0.376233888343661,0.670293809046389,-0.312700968698095,-0.691861897484968,-0.268565358756266,-0.269120426860469,-0.672902096793656,0.0483096870640487,-0.00133409052420319,0.961536867590506,0.731750713323174,-0.253734323198022,1,0.0236689765160905,-0.394387018725947,-0.14954379753135,-0.439914820653073,0.97250213953677,0.40281033367988,-0.485534395711396,0.352413506219315,-0.51404904156715,0.20267090747079,-0.125064027805593,0.116929699731482,0.680121188877407,0.223668043327365,0.0426904881646288,0.30162581478892,-0.602570380370753,-0.316141294657115,-0.534384053599637,0.116866063143665,-0.705529572546595,0.116346612367545,0.325727233502795,-0.630236494118917,0.62396847427595,0.373669527347261,0.778458542060025,0.457227258595267,-0.0677208968935176,0.905209383036809,-0.196021744026011,0.0834958705828548,-0.937694158252189,-0.483578188034204,0.635672259870543,-0.988805743549017,-0.256699223388902,0.988000498276175,0.922850592895672,-0.000886101038105824,-0.850977061710424,-0.994848250393963,-0.453749977435154,0.930648034308862,0.217572487337794,0.497604150267206,0.946140326595378,-0.34709769203807,0.259565551959026,-0.200400630678223,-0.0264054082515571,0.333930897780571,0.178815856347394,-0.574434172555217,-0.572378241340813,0.0094555578157165,0.13433907323125,-0.457915907954519,0.154363336111995,-0.0725536757778059,0.88989339596693,-0.307264391529119,-0.993927001026579,-1,-0.567304506929176,0.525495224303539,-0.314911403686857,-0.485989160991562,-0.301907492907948,-0.366737550887358,-0.62384600395285,-0.208139628982807,-0.212820170520255,0.406020625828295,-0.173413810711889,-0.348369108754012,0.0708937675955317,0.740829715090739,0.499764945636077,-0.575002110329237,0.574779846952245,-0.244908871894149,-0.0317549931714906,0.668872547932834,0.349288087494684,0.188271448211459,-0.25981626371316,-0.31555557649303,0.444073540053568,0.276850211381532,0.537292937959736,-0.901879976159012,0.0975620025468646,-0.0461362164457854,-0.947148752814725,0.953794528993235,0.405964428522919,0.0761454305294187,0.0566210453398259,0.455198452464052,-0.915307133875511,0.445722921829178,-0.193637914608656,-0.158007258177864,-0.307554365181973,-0.107955921057557,0.502501382966622,0.13488475260288,0.784982745640526,-0.141771032448208,-0.0129456874993974,0.289500063352985,0.929309859561125,0.392400188505387,-0.88512084627184,-0.27818488808226,-0.505929727892824,-0.924943668953754,0.94908159607058,0.712237771384313,0.177033781652983,-0.473879207901366,0.715818580031343,-0.593418726465464,0.20398833685446,-0.36851788074262,-0.243755133415746],"label":["Richard Smith","David Jones","Michael Miller","David Thomas","Mark Miller","Anna Wheeler","Michael Bell","Joshua Smith","Joshua Martin","John Gonzalez","Ashley Harris","Michael Williams","Amy Williams","James Smith","Jennifer Smith","Amy Martinez","Jennifer Taylor","Michael Jackson","Christopher Jones","John Williams","Lisa Johnson","Acevedo","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez","Andhra Pradesh  Limited Liability Company Ray","Andrews","Aqua Adventures Ltd. Corporation","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold","Ashley","Assam   Ltd. Liability Co","Baker","Baltic Sprat Ges.m.b.H. Enterprises","Barnett","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","Brewer Inc","Brisa del Mar GmbH","Brown and Alvarez","Brown-Evans","Byrd-Flores","Carter LLC","Chase","Chavez PLC","Choi and Merritt","Christensen and Bender","Collins and Johnson","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis","Dean-Fisher","Deep Sea Divers BV Logistics","Dickson and Gonzalez","Dnipro  Saltwater N.V. Services","Dutch Mussels S.p.A. Sea spray","Ferguson and Miller","Finley and Mcdaniel","Fowler-Davis","Garcia","Garcia and Acevedo","Garcia and Harris","Graham Inc","Group S.A. de C.V.","Hall-Taylor","Hamilton LLC","Hernandez","Hernandez and Wade","Herring","Horton and Lewis","Jacobs-Henry","Johnson","Johnson and Wright","Karelians Plc Marine conservation","Kariba Dam   CJSC Marine sanctuary","Khundu N.V. and Son's","Kidd and Hall","Kline and Roberts","Kong zhong diao yu  GmbH","Lang","Lara","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Ltd. Corporation Ltd. Corporation","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Maacama  S.p.A. Marine ecology","Malawi Rift   S.A. de C.V. Express","Malone and Willis","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal S.A. de C.V.","Mar de Cristal ОАО","Mar del Oeste -","Mar del Placer Plc","Marine Muse Pic Marine ecology","Martinez","Matthews and White","Meadows","Melanippe GmbH & Co. KG","Merritt-Austin","Montes","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Norwegian Fjord  S.A. de C.V. Brothers","Náutica del Mar GmbH & Co. KG","Ocean Quest S.A. de C.V.","Océano del Este Eel","Ola de la Costa AS","PacificPlates S.A. de C.V.","Phillips and Moody","Playa de Arena Ltd. Liability Co","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Punjab  Market Ltd. Liability Co Brothers","Punjab s Pic Express","Reese","Reyes-Kelly","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Rufiji Delta  Limited Liability Company","Sanchez PLC","Sander Ltd. Liability Co Solutions","Sea Striders Kelp BV Solutions","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","SeaSolutions Leska Kga Worldwide","Seashell Sanctum Co Family","Selkie GmbH Marine life","Shepherd and Phillips","SilverScales Ltd. Liability Co","Simon and Farmer","Singleton Ltd","Smith and Harrison","Smith and Scott","Spanish Shrimp A/S Marine","Sullivan","Taylor","Thetis Ltd. Liability Co","Thompson","TideTurner Tidepool Co Enterprises","Tucker-Turner","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttar Pradesh Sea  United","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Webb and Martin","Werner-Ortiz","West Bengal  Co _","West Fish  GmbH Transport","Wise and Fuentes","Wright LLC","Young and Ramos","hǎi mǎ S.p.A. Transport","hǎi zhé S.A. de C.V.","jīn qiāng yú AG","mán yú BV Coral Reef"]},"edges":{"from":["Richard Smith","David Jones","David Jones","Michael Miller","David Thomas","Mark Miller","Anna Wheeler","Michael Bell","Mark Miller","Richard Smith","Joshua Smith","Joshua Martin","John Gonzalez","Anna Wheeler","Joshua Martin","Joshua Smith","David Thomas","Michael Bell","Ashley Harris","Joshua Martin","Michael Williams","Ashley Harris","Michael Williams","Amy Williams","Richard Smith","James Smith","Joshua Smith","John Gonzalez","David Jones","Jennifer Smith","Michael Williams","Amy Martinez","Ashley Harris","Michael Bell","Amy Williams","Richard Smith","Mark Miller","Jennifer Smith","David Jones","Mark Miller","Michael Miller","David Jones","Michael Williams","John Gonzalez","Jennifer Taylor","Joshua Smith","Michael Jackson","James Smith","Jennifer Smith","Christopher Jones","Amy Williams","John Gonzalez","Amy Martinez","James Smith","Joshua Martin","Joshua Martin","John Williams","Christopher Jones","Amy Martinez","Ashley Harris","Michael Jackson","Lisa Johnson","Jennifer Taylor","Michael Jackson","Michael Bell","Lisa Johnson","Michael Bell","Jennifer Smith","Lisa Johnson","Jennifer Smith","Mark Miller","Amy Williams","Jennifer Smith","Lisa Johnson","Ashley Harris","Jennifer Smith","Jennifer Smith","Michael Jackson","David Thomas","Amy Martinez","Amy Martinez","Amy Williams","Jennifer Taylor","Anna Wheeler","Ashley Harris","James Smith","David Thomas","Mark Miller","Anna Wheeler","David Thomas","Michael Williams","John Williams","Anna Wheeler","Joshua Smith","John Gonzalez","Jennifer Taylor","Amy Williams","Michael Miller","Michael Bell","Joshua Smith","Michael Miller","David Jones","Lisa Johnson","David Thomas","Anna Wheeler","Michael Williams","David Jones","Jennifer Taylor","Christopher Jones","John Williams","John Williams","Amy Martinez","Joshua Martin","Jennifer Taylor","Joshua Smith","John Williams","Jennifer Taylor","Christopher Jones","Michael Williams","James Smith","John Williams","James Smith","John Williams","Jennifer Taylor","Richard Smith","John Gonzalez","John Williams","Richard Smith","Lisa Johnson","Michael Jackson","Michael Williams","Christopher Jones","James Smith","Ashley Harris","Christopher Jones","Michael Jackson","Michael Miller","Richard Smith","Ashley Harris","Michael Miller","Amy Williams","Richard Smith","Anna Wheeler","James Smith"],"to":["Acevedo","Adriatic Catch S.A. de C.V.","Alexander PLC","Alvarez","Andhra Pradesh  Limited Liability Company Ray","Andrews","Aqua Adventures Ltd. Corporation","Aqua Aura SE Marine life","Aqua Gourmet Incorporated Creek","Arnold","Ashley","Assam   Ltd. Liability Co","Baker","Baltic Sprat Ges.m.b.H. Enterprises","Barnett","Beach Bums Corporation Transit","BlueTide GmbH & Co. KG","Brewer Inc","Brisa del Mar GmbH","Brown and Alvarez","Brown-Evans","Byrd-Flores","Carter LLC","Chase","Chavez PLC","Choi and Merritt","Christensen and Bender","Collins and Johnson","Congo Rapids   AG Sea spray","Cortez Group","Costa de Coral Kga","Davis","Davis","Dean-Fisher","Deep Sea Divers BV Logistics","Dickson and Gonzalez","Dnipro  Saltwater N.V. Services","Dutch Mussels S.p.A. Sea spray","Ferguson and Miller","Finley and Mcdaniel","Fowler-Davis","Garcia","Garcia","Garcia and Acevedo","Garcia and Harris","Graham Inc","Group S.A. de C.V.","Hall-Taylor","Hamilton LLC","Hernandez","Hernandez and Wade","Herring","Horton and Lewis","Jacobs-Henry","Johnson","Johnson and Wright","Karelians Plc Marine conservation","Kariba Dam   CJSC Marine sanctuary","Khundu N.V. and Son's","Kidd and Hall","Kline and Roberts","Kong zhong diao yu  GmbH","Lang","Lara","Limpopo River  Ltd. Liability Co","Lloyd-Russell","Ltd. Corporation Ltd. Corporation","Luangwa River   Limited Liability Company Holdings","Lucas-Shelton","Maacama  S.p.A. Marine ecology","Malawi Rift   S.A. de C.V. Express","Malone and Willis","Mar de Coral GmbH and Son's","Mar de Cristal Ltd Abalone","Mar de Cristal S.A. de C.V.","Mar de Cristal ОАО","Mar del Oeste -","Mar del Placer Plc","Marine Muse Pic Marine ecology","Martinez","Matthews and White","Meadows","Melanippe GmbH & Co. KG","Merritt-Austin","Montes","Murphy-Russell","Nagaland Sea Catch Ltd. Liability Co Logistics","Norwegian Fjord  S.A. de C.V. Brothers","Náutica del Mar GmbH & Co. KG","Ocean Quest S.A. de C.V.","Océano del Este Eel","Ola de la Costa AS","PacificPlates S.A. de C.V.","Phillips and Moody","Playa de Arena Ltd. Liability Co","Playa de la Luna Starfish","Portuguese Sea Bass & N.V. Logistics","Punjab  Market Ltd. Liability Co Brothers","Punjab s Pic Express","Reese","Reyes-Kelly","Rogers-Robinson","Romero Ltd and Son's","Rubio-Evans","Rufiji Delta  Limited Liability Company","Sanchez PLC","Sander Ltd. Liability Co Solutions","Sea Striders Kelp BV Solutions","SeaSelect Foods Salt spray","SeaSolutions Dry dock OJSC Transit","SeaSolutions Leska Kga Worldwide","Seashell Sanctum Co Family","Selkie GmbH Marine life","Shepherd and Phillips","SilverScales Ltd. Liability Co","Simon and Farmer","Singleton Ltd","Smith and Harrison","Smith and Scott","Spanish Shrimp A/S Marine","Sullivan","Taylor","Thetis Ltd. Liability Co","Thompson","TideTurner Tidepool Co Enterprises","Tucker-Turner","Turkish Calamari LLC Shipping","Turkish Calamari Plc ship","Uttar Pradesh Sea  Ges.m.b.H. Industrial","Uttar Pradesh Sea  United","Velazquez-Harris","Vespuci Sandbar Sp Brothers","Walker-Lozano","Webb and Martin","Werner-Ortiz","West Bengal  Co _","West Fish  GmbH Transport","Wise and Fuentes","Wright LLC","Young and Ramos","hǎi mǎ S.p.A. Transport","hǎi zhé S.A. de C.V.","jīn qiāng yú AG","mán yú BV Coral Reef"],"type.x":["Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner","Beneficial Owner"],"weights":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,3,1,1,1,1,1,1,1,3,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,3,1,1,1,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"background":"pink","border":"red"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="companies-that-have-registered-in-multiple-countries" class="level3">
<h3 class="anchored" data-anchor-id="companies-that-have-registered-in-multiple-countries">Companies that have registered in multiple countries</h3>
<p>While it is true that companies are typically registered in the country where they are headquartered or where they conduct their primary operations, it is not unheard of for companies to be registered in multiple countries. Nevertheless for our visualisation, we wish to identify such companies as such situations may not be entirely normal and these companies may potentially breach some form of legality.</p>
<p>The bar chart below shows the companies that have registered in more than one country. It reveals that Aqua Aura SE marine Life has the highest number of countries it registers in (8 countries in total). This is followed by Transit Limited Liability Company as well as Tamil Nadu S A/S, with both registered in 4 countries each.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Derive specific edge table and filter all companies</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country <span class="ot">&lt;-</span> mc3_edges_bysource <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (source, country, type.y) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type.y <span class="sc">==</span> <span class="st">"Company"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter companies that are registered in more than 1 country</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered_one <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc3_edges_country, <span class="fu">ave</span>(source, source, <span class="at">FUN =</span> length) <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mc3_edges_country_filtered_one, <span class="fu">aes</span>(<span class="at">x =</span> source)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Companies"</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"No of countries registered"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To gather deeper insights, we will drill down to more extreme cases to uncover deeper insights on such companies. The visualisation below focuses on companies which are registered in more than 2 countries. From the network plot, we can pick up the countries that the company registers in. In the case of Aqua Aura SE Marine Life, this company has registered in 8 countries - Oceanus, Coralmarica, Alverossia, Nalakond, Rio Isla, Talandria, Icarnia and Isliandor.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filter companies that are registered in more than 2 countries</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered <span class="ot">&lt;-</span> <span class="fu">subset</span>(mc3_edges_country, <span class="fu">ave</span>(source, source, <span class="at">FUN =</span> length) <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create corresponding nodes table out of the edges table</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>id1_con <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>id2_con <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> country)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>mc3_nodes_country_filtered <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_con, id2_con) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prep format for plotting</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mc3_edges_country_filtered <span class="ot">&lt;-</span> mc3_edges_country_filtered <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">from =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="at">to =</span> country) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot interactive graph</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(mc3_nodes_country_filtered, mc3_edges_country_filtered) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"orange"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_gem"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9cfac3fe92f8f9891814" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9cfac3fe92f8f9891814">{"x":{"nodes":{"id":["Aqua Aura SE Marine life","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu bi sai  BV","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar del Paraíso GmbH","Océano del Este Co","Perla del Mar Co","Solutions Limited Liability Company","Tamil Nadu s A/S","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Korvelonia","Marebak","Zawalinda","Gavanovia","Kondarivakia","Faraluna","Kondanovia","Puerto del Mar","Puerto Sol","Kethilim","Sol y Oceana","Osterivaro","Thessalandia","Brindisola"],"x":[-0.0167607781697002,0.756851532562107,0.0937561883961229,0.19220424260329,-0.443764709769197,0.238570699106709,-0.464793747666222,-0.739225668470229,-0.689235319361183,-0.285900845519615,0.285167229005485,-0.334285549719867,-0.077116802997751,-0.151357668359403,-0.279770604200663,0.432109495210313,0.223491265079475,0.198500902431274,-0.320143704043379,-0.0162252708260273,-0.106538559735099,-0.0227315471354255,-0.20997211583965,0.251907260672854,1,0.563099188141608,0.257755001142936,-0.1397549227211,0.450688612389912,-0.554135452083094,-0.984693350560856,-1,-0.859828137880032,-0.941626609042403,0.418518716722023,0.518984189271379,-0.102979701425738,0.0330174126574627,-0.355344233835708,-0.474289218450215],"y":[-0.200984627538085,-0.662656567933045,-0.56540358950065,0.213452351557349,-0.502144789666264,-0.659802910036727,0.0676393902062171,-0.0737134542388906,-0.534018781376616,-0.618520653803688,0.564540259948439,0.115051506063057,0.466094627537734,-0.446257564671969,0.623930932680366,-0.444474103892685,-0.0639419092880394,-0.38054734083558,-0.198058095797653,0.0816118896573279,-0.829713613151128,-0.676338511019134,0.232635576980182,-0.216231901822016,-0.802563992623293,-0.892038903503964,-1,-0.133260367622683,0.323461494487283,-0.864107313003056,0.074732152664178,-0.121909833006808,-0.837049809840525,-0.677871496613477,0.90215798741525,0.760592349079062,0.844971625670145,0.82034463979053,1,0.890037781572416],"label":["Aqua Aura SE Marine life","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu bi sai  BV","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar del Paraíso GmbH","Océano del Este Co","Perla del Mar Co","Solutions Limited Liability Company","Tamil Nadu s A/S","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Korvelonia","Marebak","Zawalinda","Gavanovia","Kondarivakia","Faraluna","Kondanovia","Puerto del Mar","Puerto Sol","Kethilim","Sol y Oceana","Osterivaro","Thessalandia","Brindisola"]},"edges":{"from":["Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Aqua Aura SE Marine life","Bahía del Sol Corporation","Bahía del Sol Corporation","Bahía del Sol Corporation","Bay of Bengal's Ltd. Liability Co","Bay of Bengal's Ltd. Liability Co","Bay of Bengal's Ltd. Liability Co","Diao yu  BV Logistics","Diao yu  BV Logistics","Diao yu  BV Logistics","Diao yu bi sai  BV","Diao yu bi sai  BV","Diao yu bi sai  BV","Jammu S.A. de C.V.","Jammu S.A. de C.V.","Jammu S.A. de C.V.","Manipur  Market Ltd. Liability Co","Manipur  Market Ltd. Liability Co","Manipur  Market Ltd. Liability Co","Mar de Coral ОАО","Mar de Coral ОАО","Mar de Coral ОАО","Mar del Paraíso GmbH","Mar del Paraíso GmbH","Mar del Paraíso GmbH","Océano del Este Co","Océano del Este Co","Océano del Este Co","Perla del Mar Co","Perla del Mar Co","Perla del Mar Co","Solutions Limited Liability Company","Solutions Limited Liability Company","Solutions Limited Liability Company","Tamil Nadu s A/S","Tamil Nadu s A/S","Tamil Nadu s A/S","Tamil Nadu s A/S","Transit Limited Liability Company","Transit Limited Liability Company","Transit Limited Liability Company","Transit Limited Liability Company","Yenisei  Eel GmbH & Co. KG Services","Yenisei  Eel GmbH & Co. KG Services","Yenisei  Eel GmbH & Co. KG Services"],"to":["Mawazam","Rio Isla","Icarnia","Oceanus","Nalakond","Coralmarica","Alverossia","Isliandor","Talandria","Novarcticaa","Utoporiana","Mawazam","Coralmarica","Korvelonia","Nalakond","Nalakond","Marebak","Zawalinda","Oceanus","Marebak","Gavanovia","Utoporiana","Korvelonia","Marebak","Oceanus","Marebak","Isliandor","Kondarivakia","Oceanus","Faraluna","Oceanus","Kondanovia","Puerto del Mar","Oceanus","Marebak","Coralmarica","Puerto Sol","Nalakond","Kethilim","Nalakond","Marebak","Oceanus","Marebak","Isliandor","Sol y Oceana","Osterivaro","Nalakond","Oceanus","Alverossia","Coralmarica","Thessalandia","Brindisola","Nalakond"],"type.y":["Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company","Company"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"background":"lightgreen","border":"orange"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"from","smooth":false},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="word-cloud-on-product-services" class="level3">
<h3 class="anchored" data-anchor-id="word-cloud-on-product-services">Word cloud on product services</h3>
<p>The word cloud provides an overview of the range of product services provided by the companies. It also provides us with an indication of the more common business groups and the product mix.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>column_values <span class="ot">&lt;-</span> mc3_edges_toprevenue<span class="sc">$</span>product_services</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a Corpus</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">Corpus</span>(<span class="fu">VectorSource</span>(column_values))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Preprocess the words</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, <span class="fu">content_transformer</span>(tolower))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removePunctuation)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeNumbers)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Add custom stopwords</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>custom_stopwords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"products"</span>, <span class="st">"systems"</span>, <span class="st">"including"</span>, <span class="st">"solutions"</span>, <span class="st">"industrial"</span>, <span class="st">"wide"</span>, <span class="st">"short"</span>, <span class="st">"fat"</span>, <span class="st">"die"</span>, <span class="st">"related"</span>, <span class="st">"equipment"</span>, <span class="st">"range"</span>, <span class="st">"offers"</span>, <span class="st">"kits"</span>, <span class="st">"frozen"</span>, <span class="st">"wild"</span>, <span class="st">"kit"</span>, <span class="st">"soft"</span>, <span class="st">"hard"</span>, <span class="st">"non"</span>, <span class="st">"cooked"</span>, <span class="st">"ltl"</span>, <span class="st">"dust"</span>, <span class="st">"full"</span>, <span class="st">"processing"</span>, <span class="st">"high"</span>, <span class="st">"dried"</span>, <span class="st">"far"</span>, <span class="st">"low"</span>, <span class="st">"roll"</span>, <span class="st">"flat"</span>, <span class="st">"raw"</span>, <span class="st">"source"</span>, <span class="st">"lcl"</span>, <span class="st">"men"</span>, <span class="st">"strip"</span>, <span class="st">"include"</span>, <span class="st">"multi"</span>, <span class="st">"natural"</span>, <span class="st">"general"</span>, <span class="st">"unit"</span>, <span class="st">"care"</span>, <span class="st">"hot"</span>, <span class="st">"rare"</span>, <span class="st">"dry"</span>, <span class="st">"set"</span>, <span class="st">"provides"</span>, <span class="st">"involved"</span>, <span class="st">"ends"</span>, <span class="st">"chum"</span>, <span class="st">"freelance"</span>, <span class="st">"hvac"</span>, <span class="st">"etc"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, <span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> <span class="fu">tm_map</span>(corpus, removeWords, custom_stopwords)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a term document matrix</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>tdm <span class="ot">&lt;-</span> <span class="fu">TermDocumentMatrix</span>(corpus)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert the term document matrix to a matrix</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tdm)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate word frequencies</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>word_freq <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rowSums</span>(m), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the word cloud</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(<span class="at">words =</span> <span class="fu">names</span>(word_freq), <span class="at">freq =</span> word_freq, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">random.order =</span> <span class="cn">FALSE</span>, <span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>